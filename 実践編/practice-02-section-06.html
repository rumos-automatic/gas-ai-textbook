<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>実践編②-6: ステップ5 カスタムメニュー設定 | 生成AI×GAS 短期講座</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Hiragino Sans', 'Noto Sans JP', sans-serif;
    }
    .smooth-scroll {
      scroll-behavior: smooth;
    }
    .screenshot-placeholder {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 0.5rem;
      padding: 3rem;
      text-align: center;
      color: white;
      cursor: pointer;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .screenshot-placeholder:hover {
      transform: translateY(-4px);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }
    #imageModal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.9);
      z-index: 100;
      justify-content: center;
      align-items: center;
    }
    #imageModal.active {
      display: flex;
    }
    #imageModal img {
      max-width: 90%;
      max-height: 90%;
      object-fit: contain;
    }
  </style>
</head>
<body class="smooth-scroll bg-gray-50">

  <!-- ナビゲーション -->
  <nav class="bg-white shadow-md sticky top-0 z-40">
    <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
      <div class="flex justify-between items-center">
        <a href="../index.html" class="text-lg md:text-xl font-semibold text-indigo-600 hover:text-indigo-800 transition">
          ← トップページへ
        </a>
        <div class="flex gap-4">
          <a href="practice-02-section-05.html" class="text-base md:text-lg font-semibold text-indigo-600 hover:text-indigo-800 transition">
            ← 前へ
          </a>
          <a href="practice-02-section-07.html" class="text-base md:text-lg font-semibold text-indigo-600 hover:text-indigo-800 transition">
            次へ →
          </a>
        </div>
      </div>
    </div>
  </nav>

  <!-- メインコンテンツ -->
  <main class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-12">

    <!-- セクションタイトル -->
    <header class="mb-16 text-center">
      <div class="inline-block bg-indigo-600 text-white px-6 py-2 rounded-full mb-4">
        <span class="font-bold">ステップ 5 / 5</span>
      </div>
      <h1 class="text-5xl md:text-6xl font-bold text-gray-900 mb-6">
        カスタムメニュー設定で<br>使いやすくする
      </h1>
      <p class="text-xl md:text-2xl text-gray-600 leading-relaxed">
        ボタンクリックでツールを実行できるようにします
      </p>
    </header>

    <!-- カスタムメニューとは -->
    <section class="mb-16">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-8">
        📋 カスタムメニューとは？
      </h2>

      <p class="text-lg md:text-xl text-gray-700 leading-relaxed mb-8">
        カスタムメニューとは、スプレッドシートのメニューバーに<strong>オリジナルのボタン</strong>を追加できる機能です。これを設定することで、誰でも簡単にツールを実行できるようになります。
      </p>

      <div class="bg-gradient-to-br from-indigo-50 to-purple-50 rounded-lg p-8 mb-8">
        <h3 class="text-xl md:text-2xl font-bold text-gray-900 mb-6">
          カスタムメニューのメリット
        </h3>

        <div class="space-y-4">
          <div class="flex items-start gap-4">
            <div class="flex-shrink-0 text-2xl">✨</div>
            <div>
              <h4 class="text-lg md:text-xl font-bold text-gray-900 mb-2">
                クリックするだけでツールを実行できる
              </h4>
              <p class="text-base md:text-lg text-gray-700 leading-relaxed">
                メニューから項目を選ぶだけで、ツールが起動します。コードを見る必要がないので、初心者でも使いやすいです。
              </p>
            </div>
          </div>

          <div class="flex items-start gap-4">
            <div class="flex-shrink-0 text-2xl">🚀</div>
            <div>
              <h4 class="text-lg md:text-xl font-bold text-gray-900 mb-2">
                「拡張機能 → Apps Script」を開く必要なし
              </h4>
              <p class="text-base md:text-lg text-gray-700 leading-relaxed">
                毎回GASエディタを開いて実行ボタンを押す手間が省けます。スプレッドシート上でそのまま操作できるので、作業効率が上がります。
              </p>
            </div>
          </div>

          <div class="flex items-start gap-4">
            <div class="flex-shrink-0 text-2xl">👥</div>
            <div>
              <h4 class="text-lg md:text-xl font-bold text-gray-900 mb-2">
                初心者でも簡単に使える
              </h4>
              <p class="text-base md:text-lg text-gray-700 leading-relaxed">
                プログラミングの知識がない人でも、メニューから選ぶだけで使えます。チームで共有する際にも便利です。
              </p>
            </div>
          </div>

          <div class="flex items-start gap-4">
            <div class="flex-shrink-0 text-2xl">📂</div>
            <div>
              <h4 class="text-lg md:text-xl font-bold text-gray-900 mb-2">
                複数の機能をまとめることも可能
              </h4>
              <p class="text-base md:text-lg text-gray-700 leading-relaxed">
                1つのメニューに複数のツールを登録できるので、関連する機能をまとめて管理できます。
              </p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- 超重要ポイント -->
    <section class="mb-16">
      <div class="bg-red-50 border-l-4 border-red-600 p-8 rounded-r-lg">
        <h2 class="text-3xl md:text-4xl font-bold text-red-800 mb-6">
          ⚠️ 作り方の超重要ポイント
        </h2>

        <p class="text-xl md:text-2xl text-red-900 leading-relaxed mb-6 font-bold">
          カスタムメニューは、ツールを作ったのと<strong>【同じチャット内】</strong>で続けて依頼しましょう！
        </p>

        <p class="text-lg md:text-xl text-red-900 leading-relaxed mb-6">
          これが非常に重要です。新しいチャットで依頼すると、ChatGPTが関数名を把握していないため、エラーが発生する可能性があります。必ずツールを作成したチャットで、続けて依頼してください。
        </p>

        <div class="bg-white rounded-lg p-6 mt-6">
          <h3 class="text-xl md:text-2xl font-bold text-gray-900 mb-4">
            ❌ 悪い例
          </h3>
          <div class="bg-gray-100 p-4 rounded-lg mb-4">
            <p class="text-lg text-gray-700 mb-2"><strong>【新しいチャットで】</strong></p>
            <p class="text-base text-gray-600">→ 「メニューを作って」</p>
          </div>
          <p class="text-lg text-red-700">
            → AIが関数名を知らないのでエラー発生
          </p>
        </div>

        <div class="bg-white rounded-lg p-6 mt-6">
          <h3 class="text-xl md:text-2xl font-bold text-gray-900 mb-4">
            ✅ 良い例
          </h3>
          <div class="bg-green-100 p-4 rounded-lg mb-4">
            <p class="text-lg text-gray-700 mb-2"><strong>【ツール作成後、同じチャットで】</strong></p>
            <p class="text-base text-gray-600">→ 「このツールをメニューから実行できるようにして」</p>
          </div>
          <p class="text-lg text-green-700">
            → AIが関数名を把握しているのでスムーズ！
          </p>
        </div>
      </div>
    </section>

    <!-- 実践②をメニュー化する依頼例 -->
    <section class="mb-16">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-8">
        💬 実践②をメニュー化する依頼例
      </h2>

      <p class="text-lg md:text-xl text-gray-700 leading-relaxed mb-8">
        実践②（CSVファイル転記ツール）をメニュー化する場合の依頼例です。ツール作成後、同じチャットで以下のプロンプトを送りましょう。
      </p>

      <div class="bg-gray-900 text-gray-100 rounded-lg p-8 overflow-x-auto mb-8">
        <pre class="text-sm md:text-base leading-relaxed whitespace-pre-wrap"><code>このツールをスプレッドシートのメニューから実行できるようにしてください。

メニュー名：📦 注文管理ツール
項目名：📥 注文データを取り込む</code></pre>
      </div>

      <div class="bg-blue-50 border-l-4 border-blue-400 p-6 rounded-r-lg">
        <h3 class="text-xl md:text-2xl font-bold text-blue-800 mb-3">
          💡 これだけでOK！
        </h3>
        <p class="text-lg md:text-xl text-blue-900 leading-relaxed">
          関数名とか難しいことは気にしなくて大丈夫です。ChatGPTが自動的に判断して、カスタムメニューのコードを生成してくれます。メニュー名や項目名は、あなたの好きな名前に変更してOKです。
        </p>
      </div>
    </section>

    <!-- 実装手順 -->
    <section class="mb-16">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-8">
        🛠️ 実装手順
      </h2>

      <p class="text-lg md:text-xl text-gray-700 leading-relaxed mb-8">
        ChatGPTがカスタムメニューのコードを生成したら、以下の手順で実装します。通常、`onOpen()` という関数が追加されます。この関数は、スプレッドシートを開いたときに自動的に実行され、カスタムメニューを表示する役割を持っています。
      </p>

      <div class="bg-white rounded-lg shadow-md p-8">
        <div class="space-y-8">
          <div class="flex items-start gap-4 pb-8 border-b border-gray-200">
            <div class="flex-shrink-0 w-10 h-10 bg-indigo-600 text-white rounded-full flex items-center justify-center font-bold text-lg">
              1
            </div>
            <div class="flex-1">
              <h3 class="text-xl md:text-2xl font-bold text-gray-900 mb-4">
                ChatGPTにプロンプトを送る → コードが作成される
              </h3>
              <p class="text-lg md:text-xl text-gray-700 leading-relaxed mb-4">
                上記のプロンプトを送ると、ChatGPTがカスタムメニューのコードを生成します。通常、以下のような `onOpen()` 関数が追加されます。
              </p>
              <div class="bg-gray-900 text-gray-100 rounded-lg p-6 overflow-x-auto">
                <pre class="text-sm"><code>function onOpen() {
  const ui = SpreadsheetApp.getUi();
  ui.createMenu('📦 注文管理ツール')
    .addItem('📥 注文データを取り込む', 'importOrderData')
    .addToUi();
}

function importOrderData() {
  // CSVファイルを取り込む処理
  // ...
}</code></pre>
              </div>
              <p class="text-base md:text-lg text-gray-700 leading-relaxed mt-4">
                この `onOpen()` 関数は、スプレッドシートを開いたときに自動的に実行され、メニューバーに「📦 注文管理ツール」というメニューを追加します。
              </p>
            </div>
          </div>

          <div class="flex items-start gap-4 pb-8 border-b border-gray-200">
            <div class="flex-shrink-0 w-10 h-10 bg-indigo-600 text-white rounded-full flex items-center justify-center font-bold text-lg">
              2
            </div>
            <div class="flex-1">
              <h3 class="text-xl md:text-2xl font-bold text-gray-900 mb-4">
                スプレッドシートを開く → 「拡張機能 → Apps Script」
              </h3>
              <p class="text-lg md:text-xl text-gray-700 leading-relaxed mb-4">
                スプレッドシートを開き、メニューから<strong>「拡張機能」</strong>→<strong>「Apps Script」</strong>をクリックしてGASエディタを開きます。
              </p>
              <div class="screenshot-placeholder">
                <p class="font-bold text-lg mb-2">📸 スクリーンショットプレースホルダー</p>
                <p class="text-sm">screenshot-practice02-open-gas-editor.png</p>
                <p class="text-sm mt-2">GASエディタを開く手順</p>
              </div>
            </div>
          </div>

          <div class="flex items-start gap-4 pb-8 border-b border-gray-200">
            <div class="flex-shrink-0 w-10 h-10 bg-indigo-600 text-white rounded-full flex items-center justify-center font-bold text-lg">
              3
            </div>
            <div class="flex-1">
              <h3 class="text-xl md:text-2xl font-bold text-gray-900 mb-4">
                コードを貼り付け保存
              </h3>
              <p class="text-lg md:text-xl text-gray-700 leading-relaxed mb-4">
                ChatGPTが生成した `onOpen()` 関数を、GASエディタに貼り付けて保存します。
              </p>
              <div class="bg-red-50 border-l-4 border-red-400 p-4 rounded-r-lg">
                <h4 class="font-bold text-lg text-red-800 mb-2">重要</h4>
                <p class="text-base md:text-lg text-red-900">
                  既存のコードに `onOpen()` 関数を<strong>追加する形</strong>で貼り付けてください。既存のコードを削除しないように注意しましょう！通常、ChatGPTは「このコードを既存のコードの上に追加してください」のように指示してくれます。
                </p>
              </div>
            </div>
          </div>

          <div class="flex items-start gap-4 pb-8 border-b border-gray-200">
            <div class="flex-shrink-0 w-10 h-10 bg-indigo-600 text-white rounded-full flex items-center justify-center font-bold text-lg">
              4
            </div>
            <div class="flex-1">
              <h3 class="text-xl md:text-2xl font-bold text-gray-900 mb-4">
                スプレッドシートをリロード（F5キー）
              </h3>
              <p class="text-lg md:text-xl text-gray-700 leading-relaxed mb-4">
                コードを保存したら、スプレッドシートのタブに戻り、<strong>F5キー</strong>を押してページをリロードします。これにより、`onOpen()` 関数が実行され、カスタムメニューが表示されます。
              </p>
              <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-r-lg">
                <p class="text-base md:text-lg text-yellow-900">
                  <strong>ヒント:</strong> リロードせずにメニューが表示されることもありますが、確実に表示させるためにはF5キーでリロードするのがおすすめです。
                </p>
              </div>
            </div>
          </div>

          <div class="flex items-start gap-4">
            <div class="flex-shrink-0 w-10 h-10 bg-indigo-600 text-white rounded-full flex items-center justify-center font-bold text-lg">
              5
            </div>
            <div class="flex-1">
              <h3 class="text-xl md:text-2xl font-bold text-gray-900 mb-4">
                メニューバーに表示される！
              </h3>
              <p class="text-lg md:text-xl text-gray-700 leading-relaxed mb-4">
                リロード後、スプレッドシートのメニューバーに<strong>「📦 注文管理ツール」</strong>というメニューが追加されます。
              </p>
              <div class="screenshot-placeholder mb-4">
                <p class="font-bold text-lg mb-2">📸 スクリーンショットプレースホルダー</p>
                <p class="text-sm">screenshot-practice02-custom-menu-displayed.png</p>
                <p class="text-sm mt-2">カスタムメニューが表示された状態</p>
              </div>
              <p class="text-lg md:text-xl text-gray-700 leading-relaxed">
                クリックすると、<strong>「📥 注文データを取り込む」</strong>という項目が表示されます。この項目をクリックすると、ツールが実行されます。
              </p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ポイント -->
    <section class="mb-16">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-8">
        💡 カスタムメニューを使う際のポイント
      </h2>

      <div class="bg-white rounded-lg shadow-md p-8 space-y-6">
        <div class="flex items-start gap-4">
          <div class="flex-shrink-0 text-3xl">📝</div>
          <div>
            <h3 class="text-lg md:text-xl font-bold text-gray-900 mb-2">
              メニュー名は自由につけられる
            </h3>
            <p class="text-base md:text-lg text-gray-700 leading-relaxed">
              日本語でも英語でもOKです。わかりやすい名前をつけましょう。例：「データ管理」「自動化ツール」「業務効率化」など
            </p>
          </div>
        </div>

        <div class="flex items-start gap-4">
          <div class="flex-shrink-0 text-3xl">🎨</div>
          <div>
            <h3 class="text-lg md:text-xl font-bold text-gray-900 mb-2">
              絵文字を使うと見つけやすい
            </h3>
            <p class="text-base md:text-lg text-gray-700 leading-relaxed">
              メニューが増えても、絵文字があれば一目で分かります。例：📦、📥、📧、📊、🚀 など
            </p>
          </div>
        </div>

        <div class="flex items-start gap-4">
          <div class="flex-shrink-0 text-3xl">📂</div>
          <div>
            <h3 class="text-lg md:text-xl font-bold text-gray-900 mb-2">
              複数の機能をまとめることも可能
            </h3>
            <p class="text-base md:text-lg text-gray-700 leading-relaxed mb-4">
              1つのメニューに複数の項目を追加できます。例えば、「📦 注文管理ツール」の中に「📥 注文データを取り込む」「📊 注文データを集計」「📧 顧客にメール送信」などをまとめられます。
            </p>
            <div class="bg-gray-900 text-gray-100 rounded-lg p-6 overflow-x-auto">
              <pre class="text-sm"><code>function onOpen() {
  const ui = SpreadsheetApp.getUi();
  ui.createMenu('📦 注文管理ツール')
    .addItem('📥 注文データを取り込む', 'importOrderData')
    .addItem('📊 注文データを集計', 'aggregateOrderData')
    .addItem('📧 顧客にメール送信', 'sendEmailToCustomers')
    .addToUi();
}</code></pre>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- まとめ -->
    <section class="mb-16">
      <div class="bg-gradient-to-br from-green-50 to-blue-50 rounded-lg p-8">
        <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-6">
          ✅ カスタムメニュー設定完了！
        </h2>
        <p class="text-lg md:text-xl text-gray-700 leading-relaxed mb-6">
          お疲れ様でした！カスタムメニューの設定が完了しました。これで、スプレッドシートを開くだけで、いつでもメニューからツールを実行できるようになりましたね。
        </p>
        <ul class="list-disc pl-6 space-y-2 text-lg md:text-xl text-gray-700">
          <li>✅ 同じチャット内でカスタムメニューを依頼する重要性を理解しました</li>
          <li>✅ `onOpen()` 関数を追加して、メニューを表示できるようにしました</li>
          <li>✅ スプレッドシートをリロードして、メニューが表示されることを確認しました</li>
        </ul>
        <p class="text-lg md:text-xl text-gray-700 leading-relaxed mt-6">
          次のセクションでは、実践編②で学んだことをまとめましょう。
        </p>
      </div>
    </section>

    <!-- 次へのリンク -->
    <section class="mt-16 text-center">
      <div class="bg-indigo-50 rounded-lg p-8">
        <p class="text-lg md:text-xl text-gray-700 mb-6">
          カスタムメニューの設定が完了したら、最後にまとめを確認しましょう。
        </p>
        <a href="practice-02-section-07.html" class="inline-block bg-indigo-600 hover:bg-indigo-700 text-white font-bold text-lg md:text-xl px-8 py-4 rounded-lg transition transform hover:scale-105">
          まとめへ進む →
        </a>
      </div>
    </section>

  </main>

  <!-- 画像拡大モーダル -->
  <div id="imageModal">
    <span id="closeModal" style="position: absolute; top: 20px; right: 40px; color: white; font-size: 40px; cursor: pointer;">&times;</span>
    <img id="modalImage" src="" alt="拡大画像">
  </div>

  <!-- フッター -->
  <footer class="bg-white border-t border-gray-200 mt-16">
    <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      <p class="text-center text-gray-600">
        © 2025 生成AI×GAS 短期講座
      </p>
    </div>
  </footer>

  <script>
    // 画像拡大モーダル
    const modal = document.getElementById('imageModal');
    const modalImage = document.getElementById('modalImage');
    const closeModal = document.getElementById('closeModal');

    document.querySelectorAll('.screenshot-placeholder').forEach(placeholder => {
      placeholder.addEventListener('click', function() {
        const imgSrc = this.querySelector('img')?.src;
        if (imgSrc) {
          modalImage.src = imgSrc;
          modal.classList.add('active');
        }
      });
    });

    closeModal.addEventListener('click', () => {
      modal.classList.remove('active');
    });

    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        modal.classList.remove('active');
      }
    });

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        modal.classList.remove('active');
      }
    });
  </script>

</body>
</html>
