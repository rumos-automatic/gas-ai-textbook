<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>条件付き集計と自動抽出（普通レベル） | 実践ウォーミングアップ</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* スムーススクロール */
    html {
      scroll-behavior: smooth;
    }

    /* ドットインジケーター */
    .dot-indicator {
      position: fixed;
      right: 2rem;
      top: 50%;
      transform: translateY(-50%);
      display: flex;
      flex-direction: column;
      gap: 1rem;
      z-index: 50;
    }

    .dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background-color: #d1d5db;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
    }

    .dot.active {
      background-color: #3b82f6;
      transform: scale(1.5);
    }

    .dot:hover {
      background-color: #60a5fa;
      transform: scale(1.3);
    }

    .dot-label {
      position: absolute;
      right: 2rem;
      white-space: nowrap;
      background-color: #1f2937;
      color: white;
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
      font-size: 0.875rem;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }

    .dot:hover .dot-label {
      opacity: 1;
    }

    /* モバイルでドットインジケーターを非表示 */
    @media (max-width: 768px) {
      .dot-indicator {
        display: none;
      }
    }

    /* 画像拡大モーダル */
    #imageModal {
      display: none;
      position: fixed;
      z-index: 9999;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.9);
      align-items: center;
      justify-content: center;
    }

    #imageModal.active {
      display: flex;
    }

    #modalImage {
      max-width: 90%;
      max-height: 90%;
      object-fit: contain;
    }

    .close-modal {
      position: absolute;
      top: 2rem;
      right: 3rem;
      color: white;
      font-size: 3rem;
      font-weight: bold;
      cursor: pointer;
      transition: color 0.3s ease;
    }

    .close-modal:hover {
      color: #ef4444;
    }

    /* 画像のホバーエフェクト */
    .zoomable-image {
      cursor: pointer;
      transition: transform 0.3s ease;
    }

    .zoomable-image:hover {
      transform: scale(1.02);
    }

    /* コードブロック */
    .code-block {
      background-color: #1e293b;
      color: #e2e8f0;
      padding: 1.5rem;
      border-radius: 0.5rem;
      overflow-x: auto;
      font-family: 'Courier New', monospace;
      font-size: 0.95rem;
      line-height: 1.6;
    }
  </style>
</head>
<body class="bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 min-h-screen">

  <!-- ナビゲーション -->
  <nav class="bg-white shadow-md py-4 px-6 sticky top-0 z-40">
    <div class="max-w-5xl mx-auto flex justify-between items-center">
      <a href="../index.html" class="text-base md:text-lg font-semibold text-blue-600 hover:text-blue-800 transition">
        ← トップページへ戻る
      </a>
      <div class="flex gap-4">
        <a href="warmup-section-02.html" class="text-base md:text-lg font-semibold text-blue-600 hover:text-blue-800 transition">
          ← 前へ
        </a>
        <a href="warmup-section-04.html" class="text-base md:text-lg font-semibold text-blue-600 hover:text-blue-800 transition">
          次へ →
        </a>
      </div>
    </div>
  </nav>

  <!-- ドットインジケーター -->
  <div class="dot-indicator">
    <div class="dot active" data-target="intro">
      <span class="dot-label">このセクションで学ぶこと</span>
    </div>
    <div class="dot" data-target="what-is">
      <span class="dot-label">条件付き集計とは？</span>
    </div>
    <div class="dot" data-target="work1">
      <span class="dot-label">ワーク1：条件付き合計</span>
    </div>
    <div class="dot" data-target="work2">
      <span class="dot-label">ワーク2：商品名ごとの合計</span>
    </div>
    <div class="dot" data-target="summary">
      <span class="dot-label">まとめ</span>
    </div>
  </div>

  <!-- メインコンテンツ -->
  <main class="max-w-4xl mx-auto px-6 py-12">

    <!-- セクションタイトル -->
    <header class="mb-12 text-center">
      <div class="inline-block bg-gradient-to-r from-yellow-400 to-orange-500 text-white px-6 py-2 rounded-full text-base md:text-lg font-bold mb-4">
        実践ウォーミングアップ - セクション 3
      </div>
      <div class="inline-block bg-yellow-100 text-yellow-800 px-4 py-1 rounded-full text-sm font-bold mb-4">
        🟡 普通レベル
      </div>
      <h1 class="text-5xl md:text-6xl font-bold text-gray-900 mb-6">
        条件付き集計と自動抽出
      </h1>
      <p class="text-lg md:text-xl text-gray-700">
        スプレッドシート全体を使った「まとめ系の自動化」に挑戦してみましょう。
      </p>
    </header>

    <!-- 小セクション1: このセクションで学ぶこと -->
    <section id="intro" class="mb-16 scroll-mt-20">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-6 flex items-center">
        <span class="text-4xl mr-3">📚</span>
        このセクションで学ぶこと
      </h2>
      <div class="bg-white rounded-lg shadow-lg p-8">
        <p class="text-lg md:text-xl leading-relaxed mb-6">
          このセクションでは、「条件に合うデータだけを集計する」という、実務でよく使う機能を学びます。
        </p>
        <ul class="space-y-4">
          <li class="flex items-start">
            <span class="text-2xl mr-3">✅</span>
            <div>
              <p class="text-lg md:text-xl font-semibold mb-2">条件付き集計の基本</p>
              <p class="text-base text-gray-700">「〇〇だけ」の合計金額を出すなど、条件に合うデータのみを集計する方法を学びます</p>
            </div>
          </li>
          <li class="flex items-start">
            <span class="text-2xl mr-3">✅</span>
            <div>
              <p class="text-lg md:text-xl font-semibold mb-2">「入金済み」だけの合計を出す</p>
              <p class="text-base text-gray-700">ステータスが「入金済み」の注文だけを合計する関数を作ります</p>
            </div>
          </li>
          <li class="flex items-start">
            <span class="text-2xl mr-3">✅</span>
            <div>
              <p class="text-lg md:text-xl font-semibold mb-2">商品名ごとの売上合計を出す</p>
              <p class="text-base text-gray-700">同じ商品名ごとに売上を自動で集計する関数を作ります</p>
            </div>
          </li>
        </ul>
      </div>
    </section>

    <!-- 小セクション2: 条件付き集計とは？ -->
    <section id="what-is" class="mb-16 scroll-mt-20">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-6 flex items-center">
        <span class="text-4xl mr-3">🔍</span>
        条件付き集計とは？
      </h2>

      <div class="bg-white rounded-lg shadow-lg p-8 mb-8">
        <p class="text-lg md:text-xl leading-relaxed mb-6">
          <strong>条件付き集計</strong>とは、「特定の条件に合うデータだけを抽出して、合計や平均を出す」ことです。
        </p>
        <p class="text-lg md:text-xl leading-relaxed mb-8">
          例えば、注文データが100件あるとして、その中から「入金済み」の注文だけを合計したい場合、
          手作業で1件ずつチェックするのは大変ですよね。
          関数を使えば、この作業を一瞬で終わらせることができます。
        </p>

        <h3 class="text-xl md:text-2xl font-bold text-gray-900 mb-4">
          実務でよくあるシーン
        </h3>
        <div class="grid md:grid-cols-2 gap-6">
          <div class="bg-blue-50 rounded-lg p-6 border-2 border-blue-200">
            <p class="text-lg font-bold text-blue-900 mb-3">📊 売上管理</p>
            <ul class="space-y-2 ml-4">
              <li class="text-base text-blue-800">• 「入金済み」だけの合計金額を知りたい</li>
              <li class="text-base text-blue-800">• 「特定の商品」だけの売上を知りたい</li>
              <li class="text-base text-blue-800">• 「今月」だけの売上を知りたい</li>
            </ul>
          </div>
          <div class="bg-green-50 rounded-lg p-6 border-2 border-green-200">
            <p class="text-lg font-bold text-green-900 mb-3">📈 レポート作成</p>
            <ul class="space-y-2 ml-4">
              <li class="text-base text-green-800">• 商品カテゴリ別の売上を集計</li>
              <li class="text-base text-green-800">• 担当者ごとの実績を集計</li>
              <li class="text-base text-green-800">• 地域ごとの販売数を集計</li>
            </ul>
          </div>
        </div>
      </div>

      <div class="bg-blue-50 border-l-4 border-blue-500 p-6 rounded-r-lg">
        <p class="text-lg md:text-xl font-semibold text-blue-900 mb-3 flex items-center">
          <span class="text-2xl mr-3">💡</span>
          条件付き集計で使う代表的な関数
        </p>
        <ul class="space-y-2 ml-6">
          <li class="text-base md:text-lg text-blue-800"><strong>SUMIF関数</strong>：条件に合うデータの合計を出す</li>
          <li class="text-base md:text-lg text-blue-800"><strong>COUNTIF関数</strong>：条件に合うデータの個数を数える</li>
          <li class="text-base md:text-lg text-blue-800"><strong>SUMIFS関数</strong>：複数の条件を指定して合計を出す</li>
        </ul>
        <p class="text-base md:text-lg text-blue-800 mt-4">
          これらの関数名を覚える必要はありません。ChatGPTに目的を伝えれば、適切な関数を提案してくれます。
        </p>
      </div>
    </section>

    <!-- 小セクション3: ワーク1 -->
    <section id="work1" class="mb-16 scroll-mt-20">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-6 flex items-center">
        <span class="text-4xl mr-3">✏️</span>
        ワーク1：「入金済み」だけの合計を出す
      </h2>

      <div class="bg-white rounded-lg shadow-lg p-8 mb-8">
        <h3 class="text-xl md:text-2xl font-bold text-gray-900 mb-4">
          📝 やりたいこと
        </h3>
        <p class="text-lg md:text-xl leading-relaxed mb-6">
          注文管理シートで、<strong>「入金済み」のステータスがついている注文だけの合計金額</strong>を出してみましょう。
        </p>
        <p class="text-lg md:text-xl leading-relaxed mb-6">
          全ての注文の合計ではなく、「入金済みだけ」の合計を知ることで、
          実際に入金された金額を正確に把握できます。
        </p>

        <div class="bg-blue-50 rounded-lg p-6 mb-6">
          <h4 class="text-lg md:text-xl font-bold text-blue-900 mb-3">想定シーン</h4>
          <ul class="space-y-2 ml-6">
            <li class="text-base md:text-lg text-blue-800">G列に「ステータス」（入金済み / 未入金）が入力されている</li>
            <li class="text-base md:text-lg text-blue-800">H列に「金額」が入力されている</li>
            <li class="text-base md:text-lg text-blue-800">G列が「入金済み」の行だけ、H列の金額を合計したい</li>
          </ul>
        </div>

        <h3 class="text-xl md:text-2xl font-bold text-gray-900 mb-4">
          💬 ChatGPTに質問してみよう
        </h3>
        <p class="text-lg md:text-xl leading-relaxed mb-4">
          以下のように、ChatGPTに質問してみましょう。
        </p>
        <div class="bg-gray-100 border-l-4 border-gray-600 p-6 rounded-r-lg mb-6">
          <p class="text-base md:text-lg text-gray-900 font-semibold mb-2">ChatGPTへの質問例：</p>
          <p class="text-base md:text-lg text-gray-800">
            「G列が"入金済み"の注文だけを合計する関数を作って」
          </p>
        </div>

        <h3 class="text-xl md:text-2xl font-bold text-gray-900 mb-4">
          🤖 ChatGPTの回答例
        </h3>
        <p class="text-lg md:text-xl leading-relaxed mb-4">
          ChatGPTは、以下のような関数を提案してくれるはずです。
        </p>
        <div class="code-block mb-4">
=SUMIF(G:G,"入金済み",H:H)
        </div>
        <p class="text-base text-gray-700 mb-6">
          この関数の意味を分解すると：
        </p>
        <ul class="space-y-3 ml-6 mb-6">
          <li class="text-base md:text-lg flex items-start">
            <span class="mr-3">📌</span>
            <span><strong>G:G</strong>：G列全体を対象にする</span>
          </li>
          <li class="text-base md:text-lg flex items-start">
            <span class="mr-3">📌</span>
            <span><strong>"入金済み"</strong>：「入金済み」という条件</span>
          </li>
          <li class="text-base md:text-lg flex items-start">
            <span class="mr-3">📌</span>
            <span><strong>H:H</strong>：H列（金額）を合計する</span>
          </li>
        </ul>
        <p class="text-base text-gray-700 mb-6">
          つまり、「G列全体を見て、"入金済み"と書いてある行のH列（金額）を合計してください」という意味です。
        </p>

        <h3 class="text-xl md:text-2xl font-bold text-gray-900 mb-4">
          📋 スプレッドシートに貼り付けてみよう
        </h3>
        <p class="text-lg md:text-xl leading-relaxed mb-6">
          この関数を、集計結果を表示したいセル（例：K2セル）にコピー＆ペーストしてみましょう。
          すると、自動的に「入金済み」の注文だけの合計金額が表示されます。
        </p>

        <!-- スクリーンショットプレースホルダー -->
        <div class="bg-gray-200 rounded-lg p-12 text-center mb-6">
          <p class="text-gray-600 text-lg mb-2">📷 スクリーンショット予定</p>
          <p class="text-gray-500 text-base">ファイル名: screenshot-warmup-sumif-function.png</p>
          <p class="text-gray-500 text-sm mt-2">内容: SUMIF関数で「入金済み」だけの合計が表示されている様子</p>
        </div>
      </div>

      <div class="bg-yellow-50 border-l-4 border-yellow-500 p-6 rounded-r-lg">
        <p class="text-lg md:text-xl font-semibold text-yellow-900 mb-3 flex items-center">
          <span class="text-2xl mr-3">💡</span>
          ポイント
        </p>
        <p class="text-base md:text-lg text-yellow-800">
          SUMIF関数を使えば、条件に合うデータだけを瞬時に集計できます。
          「手作業で1件ずつチェック」していた時間が、一瞬で終わります。
        </p>
      </div>
    </section>

    <!-- 小セクション4: ワーク2 -->
    <section id="work2" class="mb-16 scroll-mt-20">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-6 flex items-center">
        <span class="text-4xl mr-3">✏️</span>
        ワーク2：商品名ごとの売上合計を出す
      </h2>

      <div class="bg-white rounded-lg shadow-lg p-8 mb-8">
        <h3 class="text-xl md:text-2xl font-bold text-gray-900 mb-4">
          📝 やりたいこと
        </h3>
        <p class="text-lg md:text-xl leading-relaxed mb-6">
          次は、<strong>同じ商品名ごとに売上を自動で合計</strong>してみましょう。
        </p>
        <p class="text-lg md:text-xl leading-relaxed mb-6">
          例えば、「商品A」が10回注文されている場合、その10回分の金額を自動で合計する、といった使い方ができます。
        </p>

        <div class="bg-blue-50 rounded-lg p-6 mb-6">
          <h4 class="text-lg md:text-xl font-bold text-blue-900 mb-3">想定シーン</h4>
          <ul class="space-y-2 ml-6">
            <li class="text-base md:text-lg text-blue-800">D列に「商品名」が入力されている</li>
            <li class="text-base md:text-lg text-blue-800">H列に「金額」が入力されている</li>
            <li class="text-base md:text-lg text-blue-800">特定の商品名（例：商品A）の合計金額を知りたい</li>
          </ul>
        </div>

        <h3 class="text-xl md:text-2xl font-bold text-gray-900 mb-4">
          💬 ChatGPTに質問してみよう
        </h3>
        <p class="text-lg md:text-xl leading-relaxed mb-4">
          以下のように、ChatGPTに質問してみましょう。
        </p>
        <div class="bg-gray-100 border-l-4 border-gray-600 p-6 rounded-r-lg mb-6">
          <p class="text-base md:text-lg text-gray-900 font-semibold mb-2">ChatGPTへの質問例：</p>
          <p class="text-base md:text-lg text-gray-800">
            「同じ商品名ごとに売上を自動で合計したい時の関数を作って」
          </p>
        </div>

        <h3 class="text-xl md:text-2xl font-bold text-gray-900 mb-4">
          🤖 ChatGPTの回答例
        </h3>
        <p class="text-lg md:text-xl leading-relaxed mb-4">
          ChatGPTは、以下のような関数を提案してくれるはずです。
        </p>
        <div class="code-block mb-4">
=SUMIF(D:D,"商品A",H:H)
        </div>
        <p class="text-base text-gray-700 mb-6">
          この関数の意味を分解すると：
        </p>
        <ul class="space-y-3 ml-6 mb-6">
          <li class="text-base md:text-lg flex items-start">
            <span class="mr-3">📌</span>
            <span><strong>D:D</strong>：D列（商品名）全体を対象にする</span>
          </li>
          <li class="text-base md:text-lg flex items-start">
            <span class="mr-3">📌</span>
            <span><strong>"商品A"</strong>：「商品A」という条件</span>
          </li>
          <li class="text-base md:text-lg flex items-start">
            <span class="mr-3">📌</span>
            <span><strong>H:H</strong>：H列（金額）を合計する</span>
          </li>
        </ul>
        <p class="text-base text-gray-700 mb-6">
          つまり、「D列全体を見て、"商品A"と書いてある行のH列（金額）を合計してください」という意味です。
        </p>

        <h3 class="text-xl md:text-2xl font-bold text-gray-900 mb-4">
          📋 さらに便利な使い方
        </h3>
        <p class="text-lg md:text-xl leading-relaxed mb-6">
          もし、複数の商品ごとの合計を一気に出したい場合は、以下のようにセル参照を使うとさらに便利です。
        </p>
        <div class="code-block mb-4">
=SUMIF(D:D,M2,H:H)
        </div>
        <p class="text-base text-gray-700 mb-6">
          このように、<strong>"商品A"</strong>の部分をセル参照（例：M2）にすると、
          M2セルに商品名を入力するだけで、自動的にその商品の合計が表示されます。
        </p>
        <p class="text-base text-gray-700 mb-6">
          この方法を使えば、商品リストを作って、それぞれの商品の売上合計を一気に出すことができます。
        </p>

        <!-- スクリーンショットプレースホルダー -->
        <div class="bg-gray-200 rounded-lg p-12 text-center mb-6">
          <p class="text-gray-600 text-lg mb-2">📷 スクリーンショット予定</p>
          <p class="text-gray-500 text-base">ファイル名: screenshot-warmup-product-sumif.png</p>
          <p class="text-gray-500 text-sm mt-2">内容: 商品名ごとの売上合計が表示されている様子</p>
        </div>
      </div>

      <div class="bg-green-50 border-l-4 border-green-500 p-6 rounded-r-lg">
        <p class="text-lg md:text-xl font-semibold text-green-900 mb-3 flex items-center">
          <span class="text-2xl mr-3">🎉</span>
          おめでとうございます！
        </p>
        <p class="text-base md:text-lg text-green-800">
          これで、条件付き集計の基本をマスターしました。
          実務でよく使う「特定の条件だけを集計する」という作業が、一瞬でできるようになりましたね。
        </p>
      </div>
    </section>

    <!-- 小セクション5: まとめ -->
    <section id="summary" class="mb-16 scroll-mt-20">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-6 flex items-center">
        <span class="text-4xl mr-3">📝</span>
        このセクションのまとめ
      </h2>
      <div class="bg-gradient-to-br from-blue-50 to-purple-50 rounded-lg shadow-lg p-8">
        <p class="text-lg md:text-xl leading-relaxed mb-6">
          皆さん、条件付き集計ができるようになりましたでしょうか？
        </p>
        <ul class="space-y-4 mb-8">
          <li class="flex items-start">
            <span class="text-2xl mr-3">✅</span>
            <div>
              <p class="text-lg md:text-xl font-semibold mb-1">SUMIF関数で条件に合うデータだけを集計できる</p>
              <p class="text-base text-gray-700">「〇〇だけ」の合計を瞬時に計算できます</p>
            </div>
          </li>
          <li class="flex items-start">
            <span class="text-2xl mr-3">✅</span>
            <div>
              <p class="text-lg md:text-xl font-semibold mb-1">「入金済み」だけの合計など、実務で役立つ集計ができる</p>
              <p class="text-base text-gray-700">手作業でチェックする時間が大幅に削減されます</p>
            </div>
          </li>
          <li class="flex items-start">
            <span class="text-2xl mr-3">✅</span>
            <div>
              <p class="text-lg md:text-xl font-semibold mb-1">商品名ごとの売上合計など、グループ別の集計も簡単</p>
              <p class="text-base text-gray-700">レポート作成の効率が大きく向上します</p>
            </div>
          </li>
        </ul>
        <p class="text-lg md:text-xl leading-relaxed">
          次のセクションでは、さらに応用的な「複数シート連携」に挑戦してみましょう。
          別のシートやスプレッドシートからデータを自動で取得する方法を学びます。
        </p>
      </div>
    </section>

    <!-- 次のセクションへのリンク -->
    <div class="text-center mt-12">
      <a href="warmup-section-04.html" class="inline-block bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white font-bold text-lg md:text-xl py-4 px-10 rounded-lg transition shadow-lg hover:shadow-xl">
        次のセクションへ進む →
      </a>
    </div>

  </main>

  <!-- 画像拡大モーダル -->
  <div id="imageModal">
    <span class="close-modal">&times;</span>
    <img id="modalImage" src="" alt="拡大表示">
  </div>

  <!-- スクリプト -->
  <script>
    // ドットインジケーター
    const dots = document.querySelectorAll('.dot');
    const sections = document.querySelectorAll('section[id]');

    // スクロール時にアクティブなドットを更新
    window.addEventListener('scroll', () => {
      let current = '';
      sections.forEach(section => {
        const sectionTop = section.offsetTop;
        const sectionHeight = section.clientHeight;
        if (scrollY >= sectionTop - 200) {
          current = section.getAttribute('id');
        }
      });

      dots.forEach(dot => {
        dot.classList.remove('active');
        if (dot.getAttribute('data-target') === current) {
          dot.classList.add('active');
        }
      });
    });

    // ドットクリックでスムーススクロール
    dots.forEach(dot => {
      dot.addEventListener('click', () => {
        const targetId = dot.getAttribute('data-target');
        const targetSection = document.getElementById(targetId);
        if (targetSection) {
          targetSection.scrollIntoView({ behavior: 'smooth' });
        }
      });
    });

    // 画像拡大モーダル
    const modal = document.getElementById('imageModal');
    const modalImage = document.getElementById('modalImage');
    const closeModal = document.querySelector('.close-modal');

    // 画像クリックでモーダル表示
    document.querySelectorAll('.zoomable-image').forEach(img => {
      img.addEventListener('click', () => {
        modal.classList.add('active');
        modalImage.src = img.src;
      });
    });

    // モーダルを閉じる
    closeModal.addEventListener('click', () => {
      modal.classList.remove('active');
    });

    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        modal.classList.remove('active');
      }
    });

    // Escキーでモーダルを閉じる
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        modal.classList.remove('active');
      }
    });
  </script>

</body>
</html>
