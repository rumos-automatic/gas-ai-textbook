# 実践編③ Googleフォーム自動返信ボット

Googleフォームの回答を受け取ったら、自動的に返信メールを送信するツールを作成します。

**推奨学習日数**：3日間

---

## 📋 この実践で学ぶこと

- Googleフォームとスプレッドシートの連携方法
- フォーム送信時のトリガー設定
- 自動返信メールの送信方法
- 回答内容に応じた処理の分岐

---

## 🎯 作業の概要

この実践では、以下のような自動化ツールを作成します：

**流れ：**
Googleフォーム → スプレッドシート → GAS → Gmail自動送信

1. ユーザーがGoogleフォームに回答
2. 回答がスプレッドシートに自動記録
3. GASが回答を検知
4. 回答者のメールアドレスに自動返信メールを送信

---

## ステップ1：作業の棚卸

まず、現在の作業を具体的に書き出しましょう。

### 現在の手作業の流れ

1. Googleフォームで回答を受け取る
2. スプレッドシートで回答を確認
3. 回答者のメールアドレスをコピー
4. Gmailで新規メールを作成
5. 件名と本文を入力
6. 送信ボタンをクリック
7. 次の回答者に対しても同じ作業を繰り返す

この作業を毎回繰り返している場合、GASで自動化することで大幅に時間を節約できます。

---

## ステップ2：Googleフォームとスプレッドシートを連携

まず、Googleフォームの回答をスプレッドシートに記録するように設定します。

### 手順

1. **Googleフォームを開く**
   - 既存のフォームを使う場合はそのフォームを開く
   - 新規作成する場合は、[Google Forms](https://forms.google.com/)から新規作成

2. **回答先を設定**
   - フォーム編集画面の「回答」タブをクリック
   - 右上の「スプレッドシートアイコン」（緑色）をクリック
   - 「新しいスプレッドシートを作成」または「既存のスプレッドシートを選択」

3. **スプレッドシートが自動作成される**
   - 「フォームの回答 1」というシートが作成される
   - フォームに回答があると、自動的にこのシートに記録される

### 重要な列

フォームの回答は、以下のような形式でスプレッドシートに記録されます：

| タイムスタンプ | メールアドレス | 質問1 | 質問2 | ... |
|--------------|--------------|------|------|-----|
| 2025/01/01 10:00:00 | user@example.com | 回答1 | 回答2 | ... |

**重要：** メールアドレスを収集する設定にしておきましょう。

#### メールアドレス収集の設定方法

1. フォーム編集画面の「設定」（歯車アイコン）をクリック
2. 「回答」タブを選択
3. 「メールアドレスを収集する」をONにする

---

## ステップ3：ChatGPTにプロンプトを送る

作業の棚卸が完了したら、ChatGPTにツール作成を依頼しましょう。

### プロンプト例

```
Google Apps Scriptで、以下の機能を持つツールを作成してください。

【やりたいこと】
Googleフォームに回答があったら、自動的に返信メールを送信する

【現在の手順】
1. Googleフォームで回答を受け取る
2. スプレッドシートに回答が記録される
   - A列：タイムスタンプ
   - B列：メールアドレス
   - C列：お名前
   - D列：お問い合わせ内容
3. 回答者のメールアドレス宛に自動返信メールを送信

【返信メールの内容】
件名：お問い合わせありがとうございます

本文：
{お名前}様

お問い合わせいただきありがとうございます。

以下の内容で受け付けました。

【お問い合わせ内容】
{お問い合わせ内容}

担当者が確認次第、ご連絡させていただきます。

よろしくお願いいたします。

【その他の要望】
- フォーム送信時に自動的に実行されるようにする
- メール送信に失敗した場合は、ログにエラー内容を出力する
```

ChatGPTが、このプロンプトに基づいてGASコードを生成してくれます。

---

## ステップ4：コードをGASエディタに貼り付け

ChatGPTが生成したコードを、GASエディタに貼り付けましょう。

### 手順

1. **スプレッドシート（フォームの回答シート）を開く**
2. **メニューから「拡張機能」→「Apps Script」をクリック**
3. **スクリプトエディタが開く**
4. **ChatGPTが生成したコードをすべて選択してコピー**
5. **エディタに貼り付け**
6. **「保存」ボタンをクリック**（Ctrl + S または Cmd + S）

---

## ステップ5：フォーム送信時トリガーを設定

このツールは、**フォームが送信されたときに自動的に実行される**必要があります。そのため、**フォーム送信時トリガー**を設定します。

### トリガー設定の手順

1. **GASエディタの左サイドバーにある「⏰ トリガー」アイコンをクリック**
2. **右下の「+ トリガーを追加」ボタンをクリック**
3. **トリガー設定画面で項目を入力**

| 項目 | 設定内容 |
|------|---------|
| **実行する関数を選択** | `sendAutoReply`（または作成した関数名） |
| **イベントのソースを選択** | スプレッドシートから |
| **イベントの種類を選択** | フォーム送信時 |

4. **「保存」ボタンをクリック**

これで、フォームが送信されるたびに、自動的に返信メールが送信されるようになります。

---

## ステップ6：動作確認

トリガー設定が完了したら、実際にフォームに回答して、動作を確認しましょう。

### 確認ポイント

1. **フォームに回答してみる**
   - テスト用のメールアドレスで回答してみる

2. **スプレッドシートに記録されているか**
   - 回答がスプレッドシートに正しく記録されているか

3. **返信メールが届いているか**
   - 回答したメールアドレスに返信メールが届いているか
   - 件名と本文が正しいか
   - 回答者の名前や問い合わせ内容が正しく挿入されているか

4. **ログを確認**
   - GASエディタの「実行ログ」でエラーが出ていないか

### もしエラーが出たら

エラーが出た場合は、エラーメッセージをコピーして、ChatGPTに送りましょう。

**例：**
```
以下のエラーが出ました。修正してください。

[エラーメッセージをここに貼り付け]
```

---

## 応用編：回答内容に応じて処理を分岐する

回答内容に応じて、異なるメールを送信することもできます。

### 例：問い合わせ種類に応じて異なるメールを送信

```
Google Apps Scriptで、フォーム回答の内容に応じて異なる返信メールを送信するように修正してください。

【条件分岐】
- 「お問い合わせ種類」が「商品について」の場合
  → 商品担当者のメールアドレス（product@example.com）もCCに追加
- 「お問い合わせ種類」が「技術サポート」の場合
  → 技術サポート担当者のメールアドレス（support@example.com）もCCに追加
```

このように、ChatGPTに追加の要望を伝えることで、より高度な自動化ツールを作成できます。

---

## 注意点

### メール送信の上限に注意

GASには、**1日に送信できるメール数に制限**があります。

- **無料アカウント**：100通/日
- **Google Workspace**：1,500通/日

大量のフォーム回答がある場合は、この制限に注意してください。

### 個人情報の取り扱いに注意

フォームで収集したメールアドレスや個人情報は、適切に管理してください。不要なメールを送信しないように注意しましょう。

---

## ✅ まとめ

この実践では、以下のことを学びました：

- Googleフォームとスプレッドシートの連携方法
- フォーム送信時トリガーの設定方法
- 自動返信メールの送信方法
- 回答内容に応じた処理の分岐

次の実践では、これまでの学習を活かして、あなた自身のオリジナルツールを作成します。お疲れ様でした！
