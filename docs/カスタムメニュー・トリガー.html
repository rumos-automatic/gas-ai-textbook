<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>生成AI × GAS 実践編③ | 自動化ツールを作ろう</title>

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- React & ReactDOM CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

    <!-- Babel Standalone for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700;900&display=swap');

        * {
            font-family: 'Noto Sans JP', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #FFF8F0 0%, #FFE8D6 100%);
            min-height: 100vh;
            scroll-snap-type: y mandatory;
            scroll-behavior: smooth;
        }

        .gradient-text {
            background: linear-gradient(135deg, #FF6B35 0%, #F7931E 50%, #FFC857 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .gradient-bg {
            background: linear-gradient(135deg, #FF6B35 0%, #F7931E 50%, #FFC857 100%);
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        .fade-in-up {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }

        .fade-in-up.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .hover-lift {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .hover-lift:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(255, 107, 53, 0.2);
        }

        .section-snap {
            scroll-snap-align: start;
            min-height: 100vh;
        }

        /* セクションインジケーター */
        .section-indicator {
            position: fixed;
            right: 2rem;
            top: 50%;
            transform: translateY(-50%);
            z-index: 50;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .section-indicator-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #D1D5DB;
            border: 2px solid #D1D5DB;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .section-indicator-dot:hover {
            background: #9CA3AF;
            border-color: #9CA3AF;
            transform: scale(1.3);
        }

        .section-indicator-dot-active {
            background: linear-gradient(135deg, #FF6B35 0%, #F7931E 100%);
            border-color: #FF6B35;
            width: 16px;
            height: 16px;
        }

        .section-indicator-item {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            gap: 0.75rem;
            height: 16px;
        }

        .section-indicator-label {
            opacity: 0;
            transition: opacity 0.3s ease;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 0.375rem 0.75rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            font-size: 0.875rem;
            font-weight: 500;
            color: #374151;
            white-space: nowrap;
            pointer-events: none;
        }

        .section-indicator-item:hover .section-indicator-label {
            opacity: 1;
        }

        /* ステップ番号 */
        .step-number {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: 900;
            color: white;
        }

        /* コードブロック風 */
        .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 12px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            overflow-x: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .code-block .keyword {
            color: #569cd6;
        }

        .code-block .string {
            color: #ce9178;
        }

        .code-block .comment {
            color: #6a9955;
        }

        /* テーブルスタイル */
        .table-container {
            overflow-x: auto;
        }

        .custom-table {
            width: 100%;
            border-collapse: collapse;
        }

        .custom-table th {
            background: linear-gradient(135deg, #FF6B35 0%, #F7931E 100%);
            color: white;
            padding: 1rem;
            text-align: left;
            font-weight: bold;
            font-size: 1.1rem;
        }

        .custom-table td {
            padding: 1rem;
            border-bottom: 1px solid #e5e7eb;
            font-size: 1rem;
        }

        .custom-table tr:nth-child(even) {
            background-color: #f9fafb;
        }

        /* ダウンロードボタン */
        .download-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 1rem 2rem;
            background: linear-gradient(135deg, #FF6B35 0%, #F7931E 100%);
            color: white;
            font-weight: bold;
            font-size: 1.2rem;
            border-radius: 12px;
            text-decoration: none;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 107, 53, 0.4);
        }

        .download-btn:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(255, 107, 53, 0.6);
        }

        @media (max-width: 768px) {
            .section-indicator {
                right: 1rem;
            }

            .section-indicator-dot {
                width: 10px;
                height: 10px;
            }

            .section-indicator-dot-active {
                width: 14px;
                height: 14px;
            }

            .section-indicator-label {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // アイコンコンポーネント
        const Icon = ({ emoji, className = "" }) => (
            <div className={`text-4xl ${className}`}>{emoji}</div>
        );

        // ① タイトルセクション
        const TitleSection = () => {
            return (
                <section className="section-snap min-h-screen flex items-center justify-center px-4 pt-10 pb-28 fade-in-up" id="section-title">
                    <div className="text-center max-w-5xl mx-auto w-full">
                        <div className="mb-6">
                            <Icon emoji="🚀" className="text-5xl md:text-6xl mb-4 animate-bounce" />
                        </div>
                        <h1 className="text-5xl md:text-6xl font-black mb-6 gradient-text">
                            生成AI × GAS 実践編③
                        </h1>
                        <p className="text-xl md:text-2xl text-gray-700 font-medium mb-8 leading-relaxed">
                            使いやすくする工夫
                        </p>

                        <div className="glass-card p-6 md:p-8 rounded-3xl shadow-xl max-w-4xl mx-auto">
                            <div className="bg-orange-50 p-6 md:p-8 rounded-2xl border-l-4 border-orange-400">
                                <div className="flex items-start">
                                    <span className="text-4xl mr-4">🎨</span>
                                    <div className="text-left">
                                        <h3 className="text-2xl md:text-3xl font-bold text-gray-800 mb-4">
                                            実践③ 使いやすくする工夫
                                        </h3>
                                        <p className="text-lg md:text-xl text-gray-700 mb-4">
                                            カスタムメニュー＆トリガー設定で完全自動化
                                        </p>
                                        <div className="bg-white p-5 rounded-xl">
                                            <h4 className="text-lg md:text-xl font-bold text-gray-800 mb-3">この実践で学ぶこと：</h4>
                                            <div className="space-y-2">
                                                <p className="text-base md:text-lg text-gray-700">✓ カスタムメニューで簡単実行</p>
                                                <p className="text-base md:text-lg text-gray-700">✓ トリガー設定で自動実行</p>
                                                <p className="text-base md:text-lg text-gray-700">✓ 完全放置の自動化を実現</p>
                                                <p className="text-base md:text-lg text-gray-700">✓ 実行時間制限の回避方法</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            );
        };

        // ② 作業の棚卸セクション（共通）
        const WorkflowSection = () => {
            return (
                <section className="section-snap min-h-screen flex items-center justify-center px-4 pt-16 pb-28 fade-in-up" id="section-workflow">
                    <div className="max-w-5xl mx-auto w-full">
                        <h2 className="text-3xl md:text-4xl font-black text-center mb-6 gradient-text">
                            🔍 AIに指示する前に：作業の棚卸
                        </h2>
                        <p className="text-lg md:text-xl text-center text-gray-700 mb-8 leading-relaxed">
                            今やっている作業を<span className="font-bold text-orange-600">言語化</span>しないと、AIに正確な指示が出せません
                        </p>

                        {/* 作業の棚卸例 */}
                        <div className="glass-card p-6 md:p-8 rounded-3xl shadow-xl max-w-3xl mx-auto">
                            <h3 className="text-xl md:text-2xl font-bold text-gray-800 mb-6 flex items-center justify-center">
                                <Icon emoji="📧" className="mr-3 text-3xl" />
                                例：条件付きメール転記
                            </h3>
                            <div className="bg-orange-50 p-5 rounded-2xl">
                                <p className="text-lg md:text-xl font-bold text-gray-800 mb-5 text-center">現在の手順を書き出す：</p>
                                <div className="space-y-3">
                                    <div className="flex items-start">
                                        <span className="step-number gradient-bg mr-3 flex-shrink-0">1</span>
                                        <p className="text-lg md:text-xl text-gray-700 mt-3">Gmailを開く</p>
                                    </div>
                                    <div className="flex items-start">
                                        <span className="step-number gradient-bg mr-3 flex-shrink-0">2</span>
                                        <p className="text-lg md:text-xl text-gray-700 mt-3">件名に「請求書」を含むメールを検索</p>
                                    </div>
                                    <div className="flex items-start">
                                        <span className="step-number gradient-bg mr-3 flex-shrink-0">3</span>
                                        <p className="text-lg md:text-xl text-gray-700 mt-3">メールを1つずつ開く</p>
                                    </div>
                                    <div className="flex items-start">
                                        <span className="step-number gradient-bg mr-3 flex-shrink-0">4</span>
                                        <p className="text-lg md:text-xl text-gray-700 mt-3">件名・差出人・受信日を確認</p>
                                    </div>
                                    <div className="flex items-start">
                                        <span className="step-number gradient-bg mr-3 flex-shrink-0">5</span>
                                        <p className="text-lg md:text-xl text-gray-700 mt-3">スプレッドシートに手動で転記</p>
                                    </div>
                                    <div className="flex items-start">
                                        <span className="step-number gradient-bg mr-3 flex-shrink-0">6</span>
                                        <p className="text-lg md:text-xl text-gray-700 mt-3">「未対応」ステータスを付ける</p>
                                    </div>
                                </div>
                            </div>
                            <div className="mt-6 text-center">
                                <p className="text-lg md:text-xl text-gray-600 italic">
                                    💡 この手順を整理することで、AIに的確な指示が出せます
                                </p>
                            </div>
                        </div>
                    </div>
                </section>
            );
        };

        // ③ ワークシート紹介セクション（共通）
        const WorksheetSection = () => {
            return (
                <section className="section-snap min-h-screen flex items-center justify-center px-4 pt-16 pb-28 fade-in-up" id="section-worksheet">
                    <div className="max-w-4xl mx-auto w-full">
                        <div className="glass-card p-6 md:p-8 rounded-3xl shadow-xl border-4 border-orange-400">
                            <div className="text-center mb-6">
                                <Icon emoji="📝" className="text-5xl md:text-6xl mb-4 animate-bounce" />
                                <h2 className="text-3xl md:text-4xl font-black mb-4 gradient-text">
                                    自動化ワークシート
                                </h2>
                            </div>

                            <p className="text-lg md:text-xl text-center text-gray-700 mb-6 leading-relaxed">
                                このワークシートを埋めると、<br/>
                                <span className="font-bold text-orange-600 text-xl md:text-2xl">そのまま生成AIに渡せます！</span>
                            </p>

                            <div className="bg-orange-50 p-5 rounded-2xl mb-6">
                                <h3 className="text-lg md:text-xl font-bold text-gray-800 mb-5 text-center">ワークシートの5つのステップ：</h3>
                                <div className="space-y-3 max-w-2xl mx-auto">
                                    <div className="flex items-center">
                                        <span className="text-2xl mr-3">1️⃣</span>
                                        <p className="text-lg md:text-xl text-gray-700 font-medium">やりたいこと（一言で）</p>
                                    </div>
                                    <div className="flex items-center">
                                        <span className="text-2xl mr-3">2️⃣</span>
                                        <p className="text-lg md:text-xl text-gray-700 font-medium">現在の手順（ステップで書き出す）</p>
                                    </div>
                                    <div className="flex items-center">
                                        <span className="text-2xl mr-3">3️⃣</span>
                                        <p className="text-lg md:text-xl text-gray-700 font-medium">どんなデータを扱う？</p>
                                    </div>
                                    <div className="flex items-center">
                                        <span className="text-2xl mr-3">4️⃣</span>
                                        <p className="text-lg md:text-xl text-gray-700 font-medium">どこに保存する？</p>
                                    </div>
                                    <div className="flex items-center">
                                        <span className="text-2xl mr-3">5️⃣</span>
                                        <p className="text-lg md:text-xl text-gray-700 font-medium">その他の要望</p>
                                    </div>
                                </div>
                            </div>

                            <div className="text-center">
                                <a href="https://drive.google.com/file/d/1NtyS-WoRwLPsSn4XWdLgUmZrP2ZAhZrw/view?usp=sharing" target="_blank" rel="noopener noreferrer" className="download-btn">
                                    <Icon emoji="📥" className="text-xl" />
                                    ワークシートをダウンロード
                                </a>
                                <p className="text-sm md:text-base text-gray-600 mt-4">
                                    ※ GoogleDriveからダウンロードして、記入しながら使えます
                                </p>
                            </div>
                        </div>
                    </div>
                </section>
            );
        };

        // ④ 実践③-1：カスタムメニュー（Practice3Part1Sectionの内容は長いため、実践編.htmlから最も重要な部分のみ抽出して簡略化）
        const Practice3Part1Section = () => {
            return (
                <section className="section-snap min-h-screen flex items-center justify-center px-4 pt-16 pb-28 fade-in-up" id="section-practice3-1">
                    <div className="max-w-6xl mx-auto w-full">
                        <h2 className="text-3xl md:text-4xl font-black text-center mb-6 gradient-text">
                            🎨 実践③ 使いやすくする工夫
                        </h2>
                        <p className="text-lg md:text-xl text-center text-gray-600 mb-10">Part 1: カスタムメニュー</p>

                        {/* カスタムメニューとは */}
                        <div className="glass-card p-8 md:p-10 rounded-3xl shadow-xl mb-8">
                            <h3 className="text-xl md:text-2xl font-bold text-gray-800 mb-6 flex items-center justify-center">
                                <Icon emoji="📋" className="mr-3 text-3xl" />
                                カスタムメニューとは
                            </h3>
                            <div className="bg-blue-50 p-6 rounded-2xl border-l-4 border-blue-400">
                                <div className="space-y-3">
                                    <p className="text-lg md:text-xl text-gray-700">✓ スプレッドシートのメニューバーに<span className="font-bold text-blue-700">オリジナルのボタン</span>を追加できる機能</p>
                                    <p className="text-lg md:text-xl text-gray-700">✓ クリックするだけで<span className="font-bold text-blue-700">ツールを実行</span>できる</p>
                                    <p className="text-lg md:text-xl text-gray-700">✓ 「拡張機能 → Apps Script」を開く必要なし！</p>
                                    <p className="text-lg md:text-xl text-gray-700">✓ <span className="font-bold text-blue-700">初心者でも簡単</span>に使える</p>
                                </div>
                            </div>
                        </div>

                        {/* 作り方の超重要ポイント */}
                        <div className="glass-card p-8 md:p-10 rounded-3xl shadow-xl mb-8 border-4 border-orange-400">
                            <h3 className="text-xl md:text-2xl font-bold text-gray-800 mb-6 text-center">
                                ⚠️ 作り方の超重要ポイント
                            </h3>
                            <div className="bg-orange-50 p-6 rounded-2xl mb-6">
                                <p className="text-lg md:text-xl text-gray-800 leading-relaxed mb-5">
                                    カスタムメニューは、ツールを作ったのと<br/>
                                    <span className="font-bold text-orange-700 text-2xl">【同じチャット内】で続けて依頼しましょう！</span>
                                </p>
                            </div>

                            <div className="grid md:grid-cols-2 gap-6 mb-6">
                                {/* 悪い例 */}
                                <div className="bg-red-50 p-6 rounded-xl border-2 border-red-300">
                                    <p className="text-lg md:text-xl font-bold text-red-700 mb-4">❌ 悪い例</p>
                                    <div className="bg-white p-4 rounded-lg">
                                        <p className="text-lg text-gray-700 mb-2">新しいチャットで</p>
                                        <p className="text-lg text-gray-800 font-bold">「メニューを作って」</p>
                                    </div>
                                    <p className="text-base text-red-600 mt-3">→ AIが関数名を知らないのでエラー</p>
                                </div>

                                {/* 良い例 */}
                                <div className="bg-green-50 p-6 rounded-xl border-2 border-green-300">
                                    <p className="text-lg md:text-xl font-bold text-green-700 mb-4">✅ 良い例</p>
                                    <div className="bg-white p-4 rounded-lg">
                                        <p className="text-lg text-gray-700 mb-2">ツール作成後、同じチャットで</p>
                                        <p className="text-lg text-gray-800 font-bold">「このツールをメニューから<br/>実行できるようにして」</p>
                                    </div>
                                    <p className="text-base text-green-600 mt-3">→ AIが関数名を把握しているのでスムーズ！</p>
                                </div>
                            </div>
                        </div>

                        {/* 実践②をメニュー化する依頼例 */}
                        <div className="glass-card p-8 md:p-10 rounded-3xl shadow-xl mb-8">
                            <h3 className="text-xl md:text-2xl font-bold text-gray-800 mb-6 flex items-center justify-center">
                                <Icon emoji="💬" className="mr-3 text-3xl" />
                                実践②をメニュー化する依頼例
                            </h3>
                            <div className="bg-green-50 p-6 rounded-2xl border-l-4 border-green-400">
                                <p className="text-base text-gray-600 mb-4 italic">（実践②のツールを作成したチャットで続けて）</p>
                                <div className="bg-white p-6 rounded-xl">
                                    <p className="text-lg md:text-xl text-gray-800 leading-relaxed">
                                        このツールをスプレッドシートのメニューから<br/>
                                        実行できるようにしてください。<br/><br/>

                                        メニュー名：📦 注文管理ツール<br/>
                                        項目名：📥 注文データを取り込む
                                    </p>
                                </div>
                                <p className="text-lg md:text-xl text-center text-gray-800 mt-5 font-bold">
                                    これだけでOK！関数名とか難しいことは気にしなくていい！
                                </p>
                            </div>
                        </div>

                        {/* 実装手順 */}
                        <div className="glass-card p-6 md:p-8 rounded-3xl shadow-xl mb-8">
                            <h3 className="text-xl md:text-2xl font-bold text-gray-800 mb-6 text-center">
                                実装手順
                            </h3>
                            <div className="space-y-4 max-w-4xl mx-auto">
                                <div className="flex items-start">
                                    <div className="step-number gradient-bg mr-3 flex-shrink-0">1</div>
                                    <p className="text-lg md:text-xl text-gray-700 mt-3">ChatGPTにプロンプトを送る → コードが作成される</p>
                                </div>
                                <div className="flex items-start">
                                    <div className="step-number gradient-bg mr-3 flex-shrink-0">2</div>
                                    <p className="text-lg md:text-xl text-gray-700 mt-3">スプレッドシートを開く → 「拡張機能 → Apps Script」</p>
                                </div>
                                <div className="flex items-start">
                                    <div className="step-number gradient-bg mr-3 flex-shrink-0">3</div>
                                    <p className="text-lg md:text-xl text-gray-700 mt-3">コードを貼り付け保存</p>
                                </div>
                                <div className="flex items-start">
                                    <div className="step-number gradient-bg mr-3 flex-shrink-0">4</div>
                                    <p className="text-lg md:text-xl text-gray-700 mt-3">スプレッドシートをリロード（F5キー）</p>
                                </div>
                                <div className="flex items-start">
                                    <div className="step-number gradient-bg mr-3 flex-shrink-0">5</div>
                                    <div className="mt-3">
                                        <p className="text-lg md:text-xl text-orange-600 font-black">メニューバーに表示される！</p>
                                        <p className="text-3xl md:text-4xl mt-2">🎉</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* ポイント */}
                        <div className="glass-card p-8 md:p-10 rounded-3xl shadow-xl">
                            <h3 className="text-xl md:text-2xl font-bold text-gray-800 mb-6 text-center">
                                💡 ポイント
                            </h3>
                            <div className="bg-blue-50 p-6 rounded-2xl">
                                <div className="space-y-3">
                                    <p className="text-lg md:text-xl text-gray-700">✓ メニュー名は<span className="font-bold text-blue-700">自由につけられる</span></p>
                                    <p className="text-lg md:text-xl text-gray-700">✓ 絵文字を使うと<span className="font-bold text-blue-700">見つけやすい</span></p>
                                    <p className="text-lg md:text-xl text-gray-700">✓ <span className="font-bold text-blue-700">複数の機能</span>をまとめることも可能</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            );
        };

        // ⑤ 実践③-2：トリガー設定
        const Practice3Part2Section = () => {
            return (
                <section className="section-snap min-h-screen flex items-center justify-center px-4 pt-16 pb-28 fade-in-up" id="section-practice3-2">
                    <div className="max-w-6xl mx-auto w-full">
                        <h2 className="text-3xl md:text-4xl font-black text-center mb-6 gradient-text">
                            🎨 実践③ 使いやすくする工夫
                        </h2>
                        <p className="text-lg md:text-xl text-center text-gray-600 mb-10">Part 2: トリガー設定</p>

                        {/* トリガーとは */}
                        <div className="glass-card p-8 md:p-10 rounded-3xl shadow-xl mb-8">
                            <h3 className="text-xl md:text-2xl font-bold text-gray-800 mb-6 flex items-center justify-center">
                                <Icon emoji="⏰" className="mr-3 text-3xl" />
                                トリガーとは
                            </h3>
                            <div className="bg-blue-50 p-6 rounded-2xl border-l-4 border-blue-400">
                                <div className="space-y-3">
                                    <p className="text-lg md:text-xl text-gray-700">✓ 指定した時間に<span className="font-bold text-blue-700">GASを自動実行</span>する機能</p>
                                    <p className="text-lg md:text-xl text-gray-700">✓ 毎日、毎時、毎週など<span className="font-bold text-blue-700">自由に設定</span>できる</p>
                                    <p className="text-lg md:text-xl text-gray-700">✓ 一度設定すれば<span className="font-bold text-blue-700">完全放置でOK！</span></p>
                                    <p className="text-lg md:text-xl text-gray-700">✓ <span className="font-bold text-blue-700">完全自動化の要</span>となる機能</p>
                                </div>
                            </div>
                        </div>

                        {/* トリガー設定の手順（簡略版） */}
                        <div className="glass-card p-8 md:p-10 rounded-3xl shadow-xl mb-8">
                            <h3 className="text-xl md:text-2xl font-bold text-gray-800 mb-8 text-center">
                                トリガー設定の手順
                            </h3>

                            <div className="space-y-4 max-w-4xl mx-auto">
                                <div className="flex items-start">
                                    <div className="step-number gradient-bg mr-3 flex-shrink-0">1</div>
                                    <p className="text-lg md:text-xl text-gray-700 mt-3">GASエディタを開く → 左サイドバーの「⏰ トリガー」をクリック</p>
                                </div>
                                <div className="flex items-start">
                                    <div className="step-number gradient-bg mr-3 flex-shrink-0">2</div>
                                    <p className="text-lg md:text-xl text-gray-700 mt-3">右下の「+ トリガーを追加」ボタンをクリック</p>
                                </div>
                                <div className="flex items-start">
                                    <div className="step-number gradient-bg mr-3 flex-shrink-0">3</div>
                                    <p className="text-lg md:text-xl text-gray-700 mt-3">「実行する関数を選択」→ プルダウンから関数名を選ぶ</p>
                                </div>
                                <div className="flex items-start">
                                    <div className="step-number gradient-bg mr-3 flex-shrink-0">4</div>
                                    <p className="text-lg md:text-xl text-gray-700 mt-3">「イベントのソースを選択」→「時間主導型」を選択</p>
                                </div>
                                <div className="flex items-start">
                                    <div className="step-number gradient-bg mr-3 flex-shrink-0">5</div>
                                    <p className="text-lg md:text-xl text-gray-700 mt-3">「時間ベースのトリガーのタイプを選択」→ 日付ベース、時間ベース、週ベースから選択</p>
                                </div>
                                <div className="flex items-start">
                                    <div className="step-number gradient-bg mr-3 flex-shrink-0">6</div>
                                    <p className="text-lg md:text-xl text-gray-700 mt-3">「時刻を選択」→ 実行したい時間帯を選択（例：午前9時〜10時）</p>
                                </div>
                                <div className="flex items-start">
                                    <div className="step-number gradient-bg mr-3 flex-shrink-0">7</div>
                                    <div className="mt-3">
                                        <p className="text-lg md:text-xl text-orange-600 font-black">「保存」をクリックして完了！</p>
                                        <p className="text-3xl md:text-4xl mt-2">🎉</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* 実践①を自動実行する設定例 */}
                        <div className="glass-card p-8 md:p-10 rounded-3xl shadow-xl mb-8">
                            <h3 className="text-xl md:text-2xl font-bold text-gray-800 mb-6 text-center">
                                実践①を自動実行する設定例
                            </h3>
                            <div className="bg-gray-50 p-6 rounded-2xl border-l-4 border-gray-400">
                                <div className="space-y-3">
                                    <p className="text-lg md:text-xl text-gray-700">• イベントのソース: <span className="font-bold text-gray-800">時間主導型</span></p>
                                    <p className="text-lg md:text-xl text-gray-700">• タイプ: <span className="font-bold text-gray-800">日付ベースのタイマー</span></p>
                                    <p className="text-lg md:text-xl text-gray-700">• 時刻: <span className="font-bold text-gray-800">午前9時〜10時</span></p>
                                </div>
                                <div className="bg-blue-50 p-4 rounded-xl mt-5">
                                    <p className="text-lg md:text-xl text-center text-gray-800">
                                        👉 <span className="font-bold text-blue-700">毎朝9時に注文メールを自動転記！</span>
                                    </p>
                                </div>
                            </div>
                        </div>

                        {/* やりすぎ注意！実行時間制限 */}
                        <div className="glass-card p-8 md:p-10 rounded-3xl shadow-xl border-4 border-red-400">
                            <h3 className="text-xl md:text-2xl font-bold text-gray-800 mb-6 text-center">
                                ⚠️ やりすぎ注意！実行時間制限
                            </h3>
                            <div className="bg-red-50 p-6 rounded-2xl">
                                <p className="text-lg md:text-xl text-gray-800 leading-relaxed mb-5">
                                    <span className="font-bold text-red-700 text-2xl">分ベースのタイマーは要注意！</span>
                                </p>
                                <div className="bg-white p-6 rounded-xl mb-4">
                                    <div className="space-y-3">
                                        <p className="text-lg text-gray-700">• 5分おき = 1日288回実行</p>
                                        <p className="text-lg text-gray-700">• 無料枠は<span className="font-bold text-orange-600">1日90分</span>の実行時間制限</p>
                                        <p className="text-lg text-red-600 font-bold">→ 制限オーバーでエラーになる可能性あり！</p>
                                    </div>
                                </div>
                                <div className="bg-green-50 p-4 rounded-lg">
                                    <p className="text-lg md:text-xl text-gray-800 font-bold mb-2">✅ 推奨設定：</p>
                                    <p className="text-lg text-gray-700">• <span className="font-bold text-green-700">日付ベースのタイマー</span>（毎日1回）</p>
                                    <p className="text-lg text-gray-700">• <span className="font-bold text-green-700">時間ベースのタイマー</span>（1時間以上の間隔）</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            );
        };

        // ⑥ 実践③-3：まとめ
        const Practice3SummarySection = () => {
            return (
                <section className="section-snap min-h-screen flex items-center justify-center px-4 pt-16 pb-28 fade-in-up" id="section-practice3-3">
                    <div className="max-w-5xl mx-auto w-full">
                        <h2 className="text-3xl md:text-4xl font-black text-center mb-6 gradient-text">
                            🎨 実践③ 使いやすくする工夫
                        </h2>
                        <p className="text-lg md:text-xl text-center text-gray-600 mb-12">まとめ</p>

                        <div className="space-y-8">
                            {/* この実践で学んだこと */}
                            <div className="glass-card p-8 md:p-10 rounded-3xl shadow-xl bg-blue-50 border-2 border-blue-300">
                                <h3 className="text-xl md:text-2xl font-bold text-gray-800 mb-6 flex items-center">
                                    <span className="text-3xl mr-3">🎓</span>
                                    この実践で学んだこと
                                </h3>
                                <p className="text-lg md:text-xl text-gray-700 leading-relaxed">
                                    カスタムメニューとトリガー設定により、GASツールをさらに使いやすく、完全自動化する方法を習得しました。
                                    誰でも簡単に使えるツールが完成します。
                                </p>
                            </div>

                            {/* 重要ポイント */}
                            <div className="glass-card p-8 md:p-10 rounded-3xl shadow-xl border-4 border-orange-400">
                                <h3 className="text-xl md:text-2xl font-bold text-gray-800 mb-6 flex items-center">
                                    <span className="text-3xl mr-3">⭐</span>
                                    重要ポイントの再確認
                                </h3>
                                <div className="space-y-4">
                                    <div className="flex items-start">
                                        <span className="text-orange-600 font-black text-xl mr-3 mt-1">✓</span>
                                        <p className="text-lg md:text-xl text-gray-700">
                                            <span className="font-bold">カスタムメニュー</span>でクリック操作だけで実行可能に
                                        </p>
                                    </div>
                                    <div className="flex items-start">
                                        <span className="text-orange-600 font-black text-xl mr-3 mt-1">✓</span>
                                        <p className="text-lg md:text-xl text-gray-700">
                                            <span className="font-bold">同じチャット内で依頼</span>することで関数名の齟齬を防ぐ
                                        </p>
                                    </div>
                                    <div className="flex items-start">
                                        <span className="text-orange-600 font-black text-xl mr-3 mt-1">✓</span>
                                        <p className="text-lg md:text-xl text-gray-700">
                                            <span className="font-bold">トリガー設定</span>で完全放置の自動実行が可能
                                        </p>
                                    </div>
                                    <div className="flex items-start">
                                        <span className="text-orange-600 font-black text-xl mr-3 mt-1">✓</span>
                                        <p className="text-lg md:text-xl text-gray-700">
                                            <span className="font-bold">実行時間制限に注意</span>（日付ベースまたは1時間以上推奨）
                                        </p>
                                    </div>
                                </div>
                            </div>

                            {/* 実行ステップの振り返り */}
                            <div className="glass-card p-8 md:p-10 rounded-3xl shadow-xl bg-green-50 border-2 border-green-300">
                                <h3 className="text-xl md:text-2xl font-bold text-gray-800 mb-6 flex items-center">
                                    <span className="text-3xl mr-3">🔄</span>
                                    実行ステップの振り返り
                                </h3>
                                <div className="text-center">
                                    <p className="text-lg md:text-xl text-gray-700 font-bold">
                                        <span className="inline-block bg-white px-4 py-2 rounded-xl shadow mx-2 my-1">① カスタムメニュー追加</span>
                                        <span className="text-green-600 text-2xl mx-2">→</span>
                                        <span className="inline-block bg-white px-4 py-2 rounded-xl shadow mx-2 my-1">② スプレッドシートリロード</span>
                                        <span className="text-green-600 text-2xl mx-2">→</span>
                                        <span className="inline-block bg-white px-4 py-2 rounded-xl shadow mx-2 my-1">③ トリガー設定で自動実行</span>
                                        <span className="text-green-600 text-2xl mx-2">→</span>
                                        <span className="inline-block bg-white px-4 py-2 rounded-xl shadow mx-2 my-1">④ 完全自動化完成！</span>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            );
        };
        // セクションインジケーター（6セクション用）
        const SectionIndicator = () => {
            const [activeSection, setActiveSection] = useState(0);
            const targetSectionIndexRef = useRef(null);
            const sectionIds = [
                'section-title',
                'section-workflow',
                'section-worksheet',
                'section-practice3-1',
                'section-practice3-2',
                'section-practice3-3'
            ];

            const sectionNames = [
                '生成AI × GAS 実践編③',
                '作業の棚卸',
                '自動化ワークシート',
                '実践③ Part 1: カスタムメニュー',
                '実践③ Part 2: トリガー設定',
                '実践③ まとめ'
            ];

            useEffect(() => {
                const options = {
                    threshold: 0.1,
                    rootMargin: '0px'
                };

                let rafId = null;
                let lastUpdateTime = 0;

                const callback = (entries) => {
                    if (rafId) {
                        cancelAnimationFrame(rafId);
                    }

                    rafId = requestAnimationFrame(() => {
                        const now = Date.now();
                        if (now - lastUpdateTime < 100) {
                            return;
                        }
                        lastUpdateTime = now;

                        const isAtBottom = window.scrollY + window.innerHeight >= document.documentElement.scrollHeight - 10;
                        if (isAtBottom) {
                            setActiveSection(sectionIds.length - 1);
                            return;
                        }

                        const intersectingSections = entries.filter(entry => entry.isIntersecting);

                        if (intersectingSections.length > 0) {
                            const centerSection = intersectingSections.reduce((closest, entry) => {
                                const rect = entry.boundingClientRect;
                                const viewportHeight = window.innerHeight;
                                const sectionCenter = rect.top + rect.height / 2;
                                const viewportCenter = viewportHeight / 2;
                                const distanceFromCenter = Math.abs(sectionCenter - viewportCenter);

                                if (!closest) return entry;

                                const closestRect = closest.boundingClientRect;
                                const closestCenter = closestRect.top + closestRect.height / 2;
                                const closestDistance = Math.abs(closestCenter - viewportCenter);

                                return distanceFromCenter < closestDistance ? entry : closest;
                            }, null);

                            if (centerSection) {
                                const newIndex = sectionIds.indexOf(centerSection.target.id);
                                if (newIndex !== -1) {
                                    const isNavigating = targetSectionIndexRef.current !== null;
                                    const hysteresisThreshold = isNavigating ? 0 : 150;

                                    setActiveSection(prevIndex => {
                                        if (prevIndex === newIndex) {
                                            if (targetSectionIndexRef.current === newIndex) {
                                                targetSectionIndexRef.current = null;
                                            }
                                            return prevIndex;
                                        }

                                        const currentElement = document.getElementById(sectionIds[prevIndex]);
                                        if (currentElement) {
                                            const currentRect = currentElement.getBoundingClientRect();
                                            const currentCenter = currentRect.top + currentRect.height / 2;
                                            const currentDistance = Math.abs(currentCenter - window.innerHeight / 2);
                                            const newDistance = Math.abs(centerSection.boundingClientRect.top + centerSection.boundingClientRect.height / 2 - window.innerHeight / 2);

                                            if (Math.abs(newDistance - currentDistance) > hysteresisThreshold) {
                                                if (targetSectionIndexRef.current === newIndex) {
                                                    targetSectionIndexRef.current = null;
                                                }
                                                return newIndex;
                                            }
                                            return prevIndex;
                                        }

                                        return newIndex;
                                    });
                                }
                            }
                        }
                    });
                };

                const observer = new IntersectionObserver(callback, options);

                sectionIds.forEach(id => {
                    const element = document.getElementById(id);
                    if (element) {
                        observer.observe(element);
                    }
                });

                return () => {
                    if (rafId) {
                        cancelAnimationFrame(rafId);
                    }
                    sectionIds.forEach(id => {
                        const element = document.getElementById(id);
                        if (element) {
                            observer.unobserve(element);
                        }
                    });
                };
            }, []);

            const scrollToSection = (index) => {
                targetSectionIndexRef.current = index;
                setActiveSection(index);
                const element = document.getElementById(sectionIds[index]);
                if (element) {
                    element.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            };

            return (
                <div className="section-indicator">
                    {sectionIds.map((id, index) => (
                        <div key={id} className="section-indicator-item">
                            <span className="section-indicator-label">{sectionNames[index]}</span>
                            <div
                                className={`section-indicator-dot ${activeSection === index ? 'section-indicator-dot-active' : ''}`}
                                onClick={() => scrollToSection(index)}
                            />
                        </div>
                    ))}
                </div>
            );
        };

        // メインアプリ（6セクション構成）
        const App = () => {
            const sectionsRef = useRef([]);

            useEffect(() => {
                const observer = new IntersectionObserver(
                    (entries) => {
                        entries.forEach((entry) => {
                            if (entry.isIntersecting) {
                                entry.target.classList.add('visible');
                            }
                        });
                    },
                    { threshold: 0.1 }
                );

                sectionsRef.current = document.querySelectorAll('.fade-in-up');
                sectionsRef.current.forEach((section) => observer.observe(section));

                return () => {
                    sectionsRef.current.forEach((section) => observer.unobserve(section));
                };
            }, []);

            return (
                <div className="overflow-x-hidden">
                    {/* 6セクション構成 */}
                    <TitleSection />
                    <WorkflowSection />
                    <WorksheetSection />
                    <Practice3Part1Section />
                    <Practice3Part2Section />
                    <Practice3SummarySection />

                    {/* セクションインジケーター */}
                    <SectionIndicator />

                    {/* Footer */}
                    <footer className="py-8 text-center text-gray-500">
                        <p className="text-sm">生成AI × GAS 短期講座 | 実践編③</p>
                    </footer>
                </div>
            );
        };

        // レンダリング
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
