# エラー修正の仕方

GASツールを作っていると、必ずエラーに遭遇します。エラーが出たときの対処法を学びましょう。

---

## 🎯 この章で学ぶこと

- エラーやうまく動かない時の指示の出し方
- 同じエラーが3回以上出る時の対処法
- チャット切り替えによる記憶リセット

---

## 1. エラーやうまく動かない時の指示の出し方

エラーが発生したり、ツールがうまく動かない場合、ChatGPTへの指示の出し方が非常に重要です。

### 💡 基本ルール

ChatGPTにエラーや問題を伝える際は、以下の2つのポイントを意識しましょう。

#### 1. 何が起きているかを具体的に伝える

**「うまくいきません」ではなく、"どのくらい・どの部分が違うか"を伝える。**

#### 2. 成功時の結果を先に伝える

**ChatGPTが"正しいゴール"を理解しやすくなる。**

---

### 💮 いい例

```
今日の注文メールは5件あるはずなのに、4件しかスプレッドシートに入力されていません。

抜けているのは「注文番号：A1234」の分です。

成功時は、5件すべて（A1234〜A1238）が転記されるはずです。
```

#### なぜ良いのか？

- **具体的な数字**：「5件あるはずなのに4件しか入力されていない」
- **どのデータが抜けたか明確**：「注文番号：A1234」
- **成功時の状態を明示**：「5件すべて（A1234〜A1238）が転記されるはず」

ChatGPTは、この情報を基に、なぜ1件抜けたのか原因を特定し、修正案を提示できます。

---

### ⚠️ 悪い例

```
なんか1件抜けてました。
うまくいかないです。
```

#### なぜ悪いのか？

- **どのデータが抜けたのか不明**
- **正しい状態（ゴール）が伝わっていない**
- **ChatGPTが状況を推測するしかない**

このような抽象的な指示では、ChatGPTは適切な修正案を提示できません。

---

### エラーメッセージが出た場合

エラーメッセージが表示された場合は、**エラーメッセージ全文をコピーして、ChatGPTに送りましょう。**

**例：**
```
以下のエラーが出ました。修正してください。

TypeError: Cannot read property 'getRange' of null at transferEmailsToSheet(コード:25)
```

このように、エラーメッセージをそのまま貼り付けることで、ChatGPTは問題の原因を特定しやすくなります。

---

## 2. 同じエラーが3回以上出る時の対処法

同じエラーが続くときは、**"同じ質問を繰り返す"のではなく、角度を変えて伝える**のがポイントです。

---

### ① Apps Scriptエディタの「実行ログ」からエラー箇所を的確に指定する

GASエディタには、「実行ログ」という機能があります。ここには、スクリプトの実行履歴やエラーメッセージが記録されています。

#### 実行ログの確認方法

1. **GASエディタを開く**
2. **左サイドバーの「実行数」アイコンをクリック**
3. **実行履歴が表示される**
4. **赤い文字のエラーメッセージ（TypeError...）を確認**
5. **エラーメッセージの前後をスクリーンショットして、エラー内容を伝える**

#### Point

**エラー内容に加えて、「どんな処理をしようとしていたか」を伝えると、AIがより正確に修正できます。**

#### 💮 いい例

```
注文メールをスプレッドシートに転記しようとしたら、このエラーが出ました。修正してください。

[スクショを添付]

TypeError: Cannot read property 'getRange' of null at transferEmailsToSheet(コード:25)
```

このように、**何をしようとしていたか**と**エラーメッセージ**の両方を伝えることで、ChatGPTは正確に問題を特定できます。

---

### ② "別の原因を探させる"依頼に切り替える

同じ修正が空振りしたら、発想のリセットを頼みます。

#### プロンプト例

```
エラーが改善しません。別の原因がないか、前提や設計を水平思考で見直してください。
```

このように依頼することで、ChatGPTは別の角度から問題を分析し、新しい解決策を提示してくれます。

---

### ③ チャットを切り替えて"記憶リセット"

同じチャットで何度も修正を繰り返すと、ChatGPTが過去の指示を引きずることがあり、それが悪さしている可能性があります。

#### 切り替える理由

**同じチャットだと過去の指示を引きずることがあるので、一回リセットするためにチャットを切り替えます。**

---

#### パターン1：コードを修正する場合

**手順：**

1. **現状を説明してもらう**
   - 現在のチャットでChatGPTに「エラーが起きている現状を説明してください。」と依頼

2. **別のチャットを開く**
   - 新しいチャットを開始

3. **コード全文とエラーの現状説明を貼り付け**
   - 前のチャットで出てきたコード全文
   - エラーの現状説明

4. **「修正してください」と依頼**

**例：**
```
以下のコードでエラーが発生しています。

【コード】
[コード全文を貼り付け]

【エラーの現状】
[現状説明を貼り付け]

修正してください。
```

---

#### パターン2：コードの作り直し

**手順：**

1. **ツールの全体像を書き出してもらう**
   - 現在のチャットでChatGPTに「このツールでやりたいことの全体像を詳細に書き出してください。」と依頼

2. **別のチャットを開く**
   - 新しいチャットを開始

3. **全体像を貼り付け**
   - 書き出してもらった全体像の詳細を貼り付け

4. **「この要件を満たすGASを作ってください」と依頼**

**例：**
```
以下の要件を満たすGoogle Apps Scriptを作成してください。

【要件】
[全体像の詳細を貼り付け]
```

この方法で、ChatGPTは過去の指示に引きずられることなく、クリーンな状態でツールを作り直してくれます。

---

## 3. エラー修正の心構え

エラー修正で最も大切なのは、**諦めないこと**です。

### 🌱 エラーは成長の機会

エラーが出ることは、**失敗ではありません**。むしろ、ツールを改善するための機会です。

- エラーが出ても落ち込まない
- 1つずつ問題を解決していく
- 修正依頼は「1回に1個」
- 根気よく改善を重ねる

### 🔄 トライ&エラーを繰り返す

AIツール作成は、**トライ&エラーの繰り返し**です。1回や2回の失敗で諦めず、粘り強くChatGPTと対話を続けましょう。

### 📝 修正履歴を記録する

何度も修正を繰り返す場合は、**修正履歴を記録しておく**と便利です。

**例：**
- 1回目：日付フォーマットを修正
- 2回目：重複チェック機能を追加
- 3回目：エラーハンドリングを追加
- 4回目：メール送信機能を追加

このように記録しておくことで、後で見返したときに、どのような改善を行ったか分かりやすくなります。

---

## ✅ まとめ

この章では、以下のことを学びました：

- **エラーやうまく動かない時の指示の出し方**
  - 具体的に「何が」「どう」違うかを伝える
  - 成功時の結果を先に伝える

- **同じエラーが3回以上出る時の対処法**
  - 実行ログからエラー箇所を特定する
  - 別の原因を探させる依頼に切り替える
  - チャットを切り替えて記憶リセット

- **エラー修正の心構え**
  - エラーは成長の機会
  - トライ&エラーを繰り返す
  - 修正履歴を記録する

エラーに遭遇したら、この章を参考にして、1つずつ問題を解決していきましょう。諦めずに続けることが、ツール完成への近道です。
