<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>生成AI × GAS 実践編① | 自動化ツールを作ろう</title>

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- React & ReactDOM CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

    <!-- Babel Standalone for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700;900&display=swap');

        * {
            font-family: 'Noto Sans JP', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #FFF8F0 0%, #FFE8D6 100%);
            min-height: 100vh;
            scroll-snap-type: y mandatory;
            scroll-behavior: smooth;
        }

        .gradient-text {
            background: linear-gradient(135deg, #FF6B35 0%, #F7931E 50%, #FFC857 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .gradient-bg {
            background: linear-gradient(135deg, #FF6B35 0%, #F7931E 50%, #FFC857 100%);
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        .fade-in-up {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }

        .fade-in-up.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .hover-lift {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .hover-lift:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(255, 107, 53, 0.2);
        }

        .section-snap {
            scroll-snap-align: start;
            min-height: 100vh;
        }

        /* セクションインジケーター */
        .section-indicator {
            position: fixed;
            right: 2rem;
            top: 50%;
            transform: translateY(-50%);
            z-index: 50;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .section-indicator-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #D1D5DB;
            border: 2px solid #D1D5DB;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .section-indicator-dot:hover {
            background: #9CA3AF;
            border-color: #9CA3AF;
            transform: scale(1.3);
        }

        .section-indicator-dot-active {
            background: linear-gradient(135deg, #FF6B35 0%, #F7931E 100%);
            border-color: #FF6B35;
            width: 16px;
            height: 16px;
        }

        .section-indicator-item {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            gap: 0.75rem;
            height: 16px;
        }

        .section-indicator-label {
            opacity: 0;
            transition: opacity 0.3s ease;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 0.375rem 0.75rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            font-size: 0.875rem;
            font-weight: 500;
            color: #374151;
            white-space: nowrap;
            pointer-events: none;
        }

        .section-indicator-item:hover .section-indicator-label {
            opacity: 1;
        }

        /* ステップ番号 */
        .step-number {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: 900;
            color: white;
        }

        /* コードブロック風 */
        .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 12px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            overflow-x: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .code-block .keyword {
            color: #569cd6;
        }

        .code-block .string {
            color: #ce9178;
        }

        .code-block .comment {
            color: #6a9955;
        }

        /* テーブルスタイル */
        .table-container {
            overflow-x: auto;
        }

        .custom-table {
            width: 100%;
            border-collapse: collapse;
        }

        .custom-table th {
            background: linear-gradient(135deg, #FF6B35 0%, #F7931E 100%);
            color: white;
            padding: 1rem;
            text-align: left;
            font-weight: bold;
            font-size: 1.1rem;
        }

        .custom-table td {
            padding: 1rem;
            border-bottom: 1px solid #e5e7eb;
            font-size: 1rem;
        }

        .custom-table tr:nth-child(even) {
            background-color: #f9fafb;
        }

        /* ダウンロードボタン */
        .download-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 1rem 2rem;
            background: linear-gradient(135deg, #FF6B35 0%, #F7931E 100%);
            color: white;
            font-weight: bold;
            font-size: 1.2rem;
            border-radius: 12px;
            text-decoration: none;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 107, 53, 0.4);
        }

        .download-btn:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(255, 107, 53, 0.6);
        }

        @media (max-width: 768px) {
            .section-indicator {
                right: 1rem;
            }

            .section-indicator-dot {
                width: 10px;
                height: 10px;
            }

            .section-indicator-dot-active {
                width: 14px;
                height: 14px;
            }

            .section-indicator-label {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // アイコンコンポーネント
        const Icon = ({ emoji, className = "" }) => (
            <div className={`text-4xl ${className}`}>{emoji}</div>
        );

        // ① タイトルセクション
        const TitleSection = () => {
            return (
                <section className="section-snap min-h-screen flex items-center justify-center px-4 pt-10 pb-28 fade-in-up" id="section-title">
                    <div className="text-center max-w-5xl mx-auto w-full">
                        <div className="mb-6">
                            <Icon emoji="🚀" className="text-5xl md:text-6xl mb-4 animate-bounce" />
                        </div>
                        <h1 className="text-5xl md:text-6xl font-black mb-6 gradient-text">
                            生成AI × GAS 実践編①
                        </h1>
                        <p className="text-xl md:text-2xl text-gray-700 font-medium mb-8 leading-relaxed">
                            注文メール → スプレッドシート転記
                        </p>

                        <div className="glass-card p-6 md:p-8 rounded-3xl shadow-xl max-w-4xl mx-auto">
                            <div className="bg-orange-50 p-6 md:p-8 rounded-2xl border-l-4 border-orange-400">
                                <div className="flex items-start">
                                    <span className="text-4xl mr-4">📧</span>
                                    <div className="text-left">
                                        <h3 className="text-2xl md:text-3xl font-bold text-gray-800 mb-4">
                                            実践① 注文メール → スプレッドシート転記
                                        </h3>
                                        <p className="text-lg md:text-xl text-gray-700 mb-4">
                                            1クリックでメール内容を抽出・転記
                                        </p>
                                        <div className="bg-white p-5 rounded-xl">
                                            <h4 className="text-lg md:text-xl font-bold text-gray-800 mb-3">この実践で学ぶこと：</h4>
                                            <div className="space-y-2">
                                                <p className="text-base md:text-lg text-gray-700">✓ Gmailから特定メールを自動取得</p>
                                                <p className="text-base md:text-lg text-gray-700">✓ 正規表現でデータを抽出</p>
                                                <p className="text-base md:text-lg text-gray-700">✓ スプレッドシートに自動転記</p>
                                                <p className="text-base md:text-lg text-gray-700">✓ 重複防止の仕組み</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            );
        };

        // ② 作業の棚卸セクション
        const WorkflowSection = () => {
            return (
                <section className="section-snap min-h-screen flex items-center justify-center px-4 pt-16 pb-28 fade-in-up" id="section-workflow">
                    <div className="max-w-5xl mx-auto w-full">
                        <h2 className="text-3xl md:text-4xl font-black text-center mb-6 gradient-text">
                            🔍 AIに指示する前に：作業の棚卸
                        </h2>
                        <p className="text-lg md:text-xl text-center text-gray-700 mb-8 leading-relaxed">
                            今やっている作業を<span className="font-bold text-orange-600">言語化</span>しないと、AIに正確な指示が出せません
                        </p>

                        {/* 作業の棚卸例 */}
                        <div className="glass-card p-6 md:p-8 rounded-3xl shadow-xl max-w-3xl mx-auto">
                            <h3 className="text-xl md:text-2xl font-bold text-gray-800 mb-6 flex items-center justify-center">
                                <Icon emoji="📧" className="mr-3 text-3xl" />
                                例：条件付きメール転記
                            </h3>
                            <div className="bg-orange-50 p-5 rounded-2xl">
                                <p className="text-lg md:text-xl font-bold text-gray-800 mb-5 text-center">現在の手順を書き出す：</p>
                                <div className="space-y-3">
                                    <div className="flex items-start">
                                        <span className="step-number gradient-bg mr-3 flex-shrink-0">1</span>
                                        <p className="text-lg md:text-xl text-gray-700 mt-3">Gmailを開く</p>
                                    </div>
                                    <div className="flex items-start">
                                        <span className="step-number gradient-bg mr-3 flex-shrink-0">2</span>
                                        <p className="text-lg md:text-xl text-gray-700 mt-3">件名に「請求書」を含むメールを検索</p>
                                    </div>
                                    <div className="flex items-start">
                                        <span className="step-number gradient-bg mr-3 flex-shrink-0">3</span>
                                        <p className="text-lg md:text-xl text-gray-700 mt-3">メールを1つずつ開く</p>
                                    </div>
                                    <div className="flex items-start">
                                        <span className="step-number gradient-bg mr-3 flex-shrink-0">4</span>
                                        <p className="text-lg md:text-xl text-gray-700 mt-3">件名・差出人・受信日を確認</p>
                                    </div>
                                    <div className="flex items-start">
                                        <span className="step-number gradient-bg mr-3 flex-shrink-0">5</span>
                                        <p className="text-lg md:text-xl text-gray-700 mt-3">スプレッドシートに手動で転記</p>
                                    </div>
                                    <div className="flex items-start">
                                        <span className="step-number gradient-bg mr-3 flex-shrink-0">6</span>
                                        <p className="text-lg md:text-xl text-gray-700 mt-3">「未対応」ステータスを付ける</p>
                                    </div>
                                </div>
                            </div>
                            <div className="mt-6 text-center">
                                <p className="text-lg md:text-xl text-gray-600 italic">
                                    💡 この手順を整理することで、AIに的確な指示が出せます
                                </p>
                            </div>
                        </div>
                    </div>
                </section>
            );
        };

        // ③ ワークシート紹介セクション
        const WorksheetSection = () => {
            return (
                <section className="section-snap min-h-screen flex items-center justify-center px-4 pt-16 pb-28 fade-in-up" id="section-worksheet">
                    <div className="max-w-4xl mx-auto w-full">
                        <div className="glass-card p-6 md:p-8 rounded-3xl shadow-xl border-4 border-orange-400">
                            <div className="text-center mb-6">
                                <Icon emoji="📝" className="text-5xl md:text-6xl mb-4 animate-bounce" />
                                <h2 className="text-3xl md:text-4xl font-black mb-4 gradient-text">
                                    自動化ワークシート
                                </h2>
                            </div>

                            <p className="text-lg md:text-xl text-center text-gray-700 mb-6 leading-relaxed">
                                このワークシートを埋めると、<br/>
                                <span className="font-bold text-orange-600 text-xl md:text-2xl">そのまま生成AIに渡せます！</span>
                            </p>

                            <div className="bg-orange-50 p-5 rounded-2xl mb-6">
                                <h3 className="text-lg md:text-xl font-bold text-gray-800 mb-5 text-center">ワークシートの5つのステップ：</h3>
                                <div className="space-y-3 max-w-2xl mx-auto">
                                    <div className="flex items-center">
                                        <span className="text-2xl mr-3">1️⃣</span>
                                        <p className="text-lg md:text-xl text-gray-700 font-medium">やりたいこと（一言で）</p>
                                    </div>
                                    <div className="flex items-center">
                                        <span className="text-2xl mr-3">2️⃣</span>
                                        <p className="text-lg md:text-xl text-gray-700 font-medium">現在の手順（ステップで書き出す）</p>
                                    </div>
                                    <div className="flex items-center">
                                        <span className="text-2xl mr-3">3️⃣</span>
                                        <p className="text-lg md:text-xl text-gray-700 font-medium">どんなデータを扱う？</p>
                                    </div>
                                    <div className="flex items-center">
                                        <span className="text-2xl mr-3">4️⃣</span>
                                        <p className="text-lg md:text-xl text-gray-700 font-medium">どこに保存する？</p>
                                    </div>
                                    <div className="flex items-center">
                                        <span className="text-2xl mr-3">5️⃣</span>
                                        <p className="text-lg md:text-xl text-gray-700 font-medium">その他の要望</p>
                                    </div>
                                </div>
                            </div>

                            <div className="text-center">
                                <a href="https://drive.google.com/file/d/1NtyS-WoRwLPsSn4XWdLgUmZrP2ZAhZrw/view?usp=sharing" target="_blank" rel="noopener noreferrer" className="download-btn">
                                    <Icon emoji="📥" className="text-xl" />
                                    ワークシートをダウンロード
                                </a>
                                <p className="text-sm md:text-base text-gray-600 mt-4">
                                    ※ GoogleDriveからダウンロードして、記入しながら使えます
                                </p>
                            </div>
                        </div>
                    </div>
                </section>
            );
        };

        // ④ 実践①-0：この実践の流れ
        const Practice1FlowSection = () => {
            return (
                <section className="section-snap min-h-screen flex items-center justify-center px-4 pt-16 pb-28 fade-in-up" id="section-practice1-0">
                    <div className="max-w-5xl mx-auto w-full">
                        <h2 className="text-3xl md:text-4xl font-black text-center mb-6 gradient-text">
                            📧 実践① 注文メール → スプレッドシート転記
                        </h2>
                        <p className="text-lg md:text-xl text-center text-gray-600 mb-12">この実践の流れ</p>

                        <div className="space-y-6 max-w-4xl mx-auto">
                            {/* Part 1 */}
                            <div className="flex items-start glass-card p-6 rounded-2xl hover-lift">
                                <div className="step-number gradient-bg mr-4 flex-shrink-0">1</div>
                                <div>
                                    <h3 className="text-xl md:text-2xl font-bold text-gray-800 mb-2">
                                        Part 1: メールサンプル
                                    </h3>
                                    <p className="text-lg text-gray-600">
                                        実際の注文メールの形式を確認します
                                    </p>
                                </div>
                            </div>

                            {/* Part 2 */}
                            <div className="flex items-start glass-card p-6 rounded-2xl hover-lift">
                                <div className="step-number gradient-bg mr-4 flex-shrink-0">2</div>
                                <div>
                                    <h3 className="text-xl md:text-2xl font-bold text-gray-800 mb-2">
                                        Part 2: 転記項目
                                    </h3>
                                    <p className="text-lg text-gray-600">
                                        どのデータをどの列に転記するか設計します
                                    </p>
                                </div>
                            </div>

                            {/* Part 3 */}
                            <div className="flex items-start glass-card p-6 rounded-2xl hover-lift">
                                <div className="step-number gradient-bg mr-4 flex-shrink-0">3</div>
                                <div>
                                    <h3 className="text-xl md:text-2xl font-bold text-gray-800 mb-2">
                                        Part 3: プロンプト例
                                    </h3>
                                    <p className="text-lg text-gray-600">
                                        生成AIへの指示文を確認します
                                    </p>
                                </div>
                            </div>

                            {/* Part 4 */}
                            <div className="flex items-start glass-card p-6 rounded-2xl hover-lift">
                                <div className="step-number gradient-bg mr-4 flex-shrink-0">4</div>
                                <div>
                                    <h3 className="text-xl md:text-2xl font-bold text-gray-800 mb-2">
                                        Part 4: 実行編
                                    </h3>
                                    <p className="text-lg text-gray-600">
                                        コードを貼り付けて実行します
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            );
        };

        // ⑤ 実践①-1：メールサンプル
        const Practice1Part1Section = () => {
            return (
                <section className="section-snap min-h-screen flex items-center justify-center px-4 pt-16 pb-28 fade-in-up" id="section-practice1-1">
                    <div className="max-w-6xl mx-auto w-full">
                        <h2 className="text-3xl md:text-4xl font-black text-center mb-6 gradient-text">
                            📧 実践① 注文メール → スプレッドシート転記
                        </h2>
                        <p className="text-lg md:text-xl text-center text-gray-600 mb-10">Part 1: メールサンプル</p>

                        {/* ゴール */}
                        <div className="glass-card p-8 md:p-10 rounded-3xl shadow-xl mb-8">
                            <h3 className="text-xl md:text-2xl font-bold text-gray-800 mb-6 flex items-center justify-center">
                                <Icon emoji="🎯" className="mr-3 text-3xl" />
                                ゴール
                            </h3>
                            <p className="text-lg md:text-xl text-gray-700 leading-relaxed text-center">
                                注文メールの内容を抽出して、1クリックでシートへ転記
                            </p>
                        </div>

                        {/* サンプル注文メール */}
                        <div className="glass-card p-8 md:p-10 rounded-3xl shadow-xl">
                            <h3 className="text-xl md:text-2xl font-bold text-gray-800 mb-8 flex items-center justify-center">
                                <Icon emoji="📨" className="mr-3 text-3xl" />
                                サンプル：注文メールの形式
                            </h3>

                            {/* メール風デザイン */}
                            <div className="bg-white p-6 md:p-8 rounded-2xl border-2 border-gray-300 shadow-lg max-w-4xl mx-auto">
                                {/* メールヘッダー */}
                                <div className="border-b-2 border-gray-200 pb-5 mb-6">
                                    <div className="mb-3">
                                        <span className="text-lg font-bold text-gray-600">件名：</span>
                                        <span className="text-lg md:text-xl font-bold text-gray-800 ml-2">【注文受付】#12345 山田太郎様</span>
                                    </div>
                                    <div className="mb-2">
                                        <span className="text-lg font-bold text-gray-600">差出人：</span>
                                        <span className="text-lg text-gray-700 ml-2">shop@example.com</span>
                                    </div>
                                    <div>
                                        <span className="text-lg font-bold text-gray-600">受信日時：</span>
                                        <span className="text-lg text-gray-700 ml-2">2025/10/28 14:30</span>
                                    </div>
                                </div>

                                {/* メール本文 */}
                                <div className="space-y-5">
                                    <div className="text-center py-3 bg-orange-50 rounded-lg">
                                        <p className="text-lg md:text-xl font-bold text-orange-600">━━━━━━━━━━━━━━━━━━</p>
                                        <p className="text-lg md:text-xl font-bold text-gray-800 py-2">ご注文ありがとうございます</p>
                                        <p className="text-lg md:text-xl font-bold text-orange-600">━━━━━━━━━━━━━━━━━━</p>
                                    </div>

                                    <div className="bg-gray-50 p-5 rounded-xl">
                                        <h4 className="text-lg md:text-xl font-bold text-gray-800 mb-4">お客様情報</h4>
                                        <div className="space-y-2">
                                            <p className="text-lg text-gray-700"><span className="font-bold">注文ID:</span> 12345</p>
                                            <p className="text-lg text-gray-700"><span className="font-bold">注文日時:</span> 2025/10/28 14:30</p>
                                            <p className="text-lg text-gray-700"><span className="font-bold">お客様名:</span> 山田太郎</p>
                                            <p className="text-lg text-gray-700"><span className="font-bold">メールアドレス:</span> yamada@example.com</p>
                                            <p className="text-lg text-gray-700"><span className="font-bold">電話番号:</span> 090-1234-5678</p>
                                        </div>
                                    </div>

                                    <div className="bg-blue-50 p-5 rounded-xl">
                                        <h4 className="text-lg md:text-xl font-bold text-gray-800 mb-4">【ご注文内容】</h4>
                                        <div className="space-y-2">
                                            <p className="text-lg text-gray-700"><span className="font-bold">商品名:</span> 有機りんご 5kg</p>
                                            <p className="text-lg text-gray-700"><span className="font-bold">数量:</span> 2箱</p>
                                            <p className="text-lg md:text-xl text-orange-600 font-bold mt-3"><span className="font-bold">小計:</span> 5,600円</p>
                                        </div>
                                    </div>

                                    <div className="bg-green-50 p-5 rounded-xl">
                                        <h4 className="text-lg md:text-xl font-bold text-gray-800 mb-4">配送情報</h4>
                                        <div className="space-y-2">
                                            <p className="text-lg text-gray-700"><span className="font-bold">配送先住所:</span> 東京都渋谷区〇〇1-2-3</p>
                                            <p className="text-lg text-gray-700"><span className="font-bold">配送希望日:</span> 2025/11/01</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            );
        };

        // ⑥ 実践①-2：転記項目
        const Practice1Part2Section = () => {
            return (
                <section className="section-snap min-h-screen flex items-center justify-center px-4 pt-16 pb-28 fade-in-up" id="section-practice1-2">
                    <div className="max-w-6xl mx-auto w-full">
                        <h2 className="text-3xl md:text-4xl font-black text-center mb-6 gradient-text">
                            📧 実践① 注文メール → スプレッドシート転記
                        </h2>
                        <p className="text-lg md:text-xl text-center text-gray-600 mb-10">Part 2: 転記項目</p>

                        <div className="glass-card p-8 md:p-10 rounded-3xl shadow-xl border-4 border-orange-400">
                            <h3 className="text-xl md:text-2xl font-bold text-gray-800 mb-8 text-center">
                                📊 転記先シートの転記項目
                            </h3>

                            {/* 導入説明 */}
                            <div className="bg-blue-50 p-6 rounded-2xl mb-8">
                                <p className="text-lg md:text-xl text-gray-800 leading-relaxed mb-5">
                                    メールから<span className="font-bold text-blue-700">取得したい項目</span>と<span className="font-bold text-blue-700">転記したい列</span>を、<br/>
                                    事前に表にしておきましょう！
                                </p>
                                <div className="bg-white p-5 rounded-xl">
                                    <h4 className="text-lg md:text-xl font-bold text-gray-800 mb-3">なぜ表を作るの？</h4>
                                    <div className="space-y-2">
                                        <p className="text-lg text-gray-700">✓ 生成AIが<span className="font-bold">何を抽出すればいいか</span>明確に理解できる</p>
                                        <p className="text-lg text-gray-700">✓ サンプルデータがあることで、<span className="font-bold">出力形式も正確に</span></p>
                                        <p className="text-lg text-gray-700">✓ 自分でも整理できるので、<span className="font-bold">後から修正しやすい</span></p>
                                    </div>
                                </div>
                            </div>

                            <div className="table-container">
                                <table className="custom-table">
                                    <thead>
                                        <tr>
                                            <th className="p-4 text-lg">項目名</th>
                                            <th className="p-4 text-lg">列</th>
                                            <th className="p-4 text-lg">抽出内容サンプル</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td className="p-4 text-lg font-bold text-gray-800">注文ID</td>
                                            <td className="p-4 text-lg md:text-xl font-black text-orange-600">A</td>
                                            <td className="p-4 text-lg text-gray-700">12345</td>
                                        </tr>
                                        <tr>
                                            <td className="p-4 text-lg font-bold text-gray-800">注文日時</td>
                                            <td className="p-4 text-lg md:text-xl font-black text-orange-600">B</td>
                                            <td className="p-4 text-lg text-gray-700">2025/10/28 14:30</td>
                                        </tr>
                                        <tr>
                                            <td className="p-4 text-lg font-bold text-gray-800">お客様名</td>
                                            <td className="p-4 text-lg md:text-xl font-black text-orange-600">C</td>
                                            <td className="p-4 text-lg text-gray-700">山田太郎</td>
                                        </tr>
                                        <tr>
                                            <td className="p-4 text-lg font-bold text-gray-800">メールアドレス</td>
                                            <td className="p-4 text-lg md:text-xl font-black text-orange-600">D</td>
                                            <td className="p-4 text-lg text-gray-700">yamada@example.com</td>
                                        </tr>
                                        <tr>
                                            <td className="p-4 text-lg font-bold text-gray-800">電話番号</td>
                                            <td className="p-4 text-lg md:text-xl font-black text-orange-600">E</td>
                                            <td className="p-4 text-lg text-gray-700">090-1234-5678</td>
                                        </tr>
                                        <tr>
                                            <td className="p-4 text-lg font-bold text-gray-800">商品名</td>
                                            <td className="p-4 text-lg md:text-xl font-black text-orange-600">F</td>
                                            <td className="p-4 text-lg text-gray-700">有機りんご 5kg</td>
                                        </tr>
                                        <tr>
                                            <td className="p-4 text-lg font-bold text-gray-800">数量</td>
                                            <td className="p-4 text-lg md:text-xl font-black text-orange-600">G</td>
                                            <td className="p-4 text-lg text-gray-700">2箱</td>
                                        </tr>
                                        <tr>
                                            <td className="p-4 text-lg font-bold text-gray-800">金額</td>
                                            <td className="p-4 text-lg md:text-xl font-black text-orange-600">H</td>
                                            <td className="p-4 text-lg text-gray-700">5600</td>
                                        </tr>
                                        <tr>
                                            <td className="p-4 text-lg font-bold text-gray-800">配送先住所</td>
                                            <td className="p-4 text-lg md:text-xl font-black text-orange-600">I</td>
                                            <td className="p-4 text-lg text-gray-700">東京都渋谷区〇〇1-2-3</td>
                                        </tr>
                                        <tr>
                                            <td className="p-4 text-lg font-bold text-gray-800">配送希望日</td>
                                            <td className="p-4 text-lg md:text-xl font-black text-orange-600">J</td>
                                            <td className="p-4 text-lg text-gray-700">2025/11/01</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                            {/* 応用メッセージ */}
                            <div className="bg-orange-50 p-6 rounded-2xl mt-8 mb-6">
                                <p className="text-lg md:text-xl text-center text-gray-800 leading-relaxed">
                                    <span className="font-bold text-orange-600">💡 この対応表を真似して、</span><br/>
                                    自分の業務に合わせた自動化ツールが作れます！
                                </p>
                            </div>

                            <div className="bg-blue-50 p-6 rounded-2xl">
                                <h4 className="text-lg md:text-xl font-bold text-gray-800 mb-4 text-center">
                                    📝 自分の業務に応用するには
                                </h4>
                                <div className="space-y-2 max-w-3xl mx-auto">
                                    <p className="text-lg text-gray-700">✓ 「項目名」欄を自分が抽出したいデータに置き換える</p>
                                    <p className="text-lg text-gray-700">✓ 「列」は<span className="font-bold text-blue-700">既存シートで使いたい列を指定</span>（C列、E列、J列など飛び飛びでもOK）</p>
                                    <p className="text-lg text-gray-700">✓ 「抽出内容サンプル」に実際のデータ例を書く</p>
                                    <p className="text-lg text-gray-700">✓ この表をそのまま生成AIへのプロンプトに貼り付ければOK！</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            );
        };

        // ⑦ 実践①-3：プロンプト例
        const Practice1Part3Section = () => {
            return (
                <section className="section-snap min-h-screen flex items-center justify-center px-4 pt-16 pb-28 fade-in-up" id="section-practice1-3">
                    <div className="max-w-6xl mx-auto w-full">
                        <h2 className="text-3xl md:text-4xl font-black text-center mb-6 gradient-text">
                            📧 実践① 注文メール → スプレッドシート転記
                        </h2>
                        <p className="text-lg md:text-xl text-center text-gray-600 mb-10">Part 3: プロンプト例</p>

                        {/* 生成AIへのプロンプト例 */}
                        <div className="glass-card p-8 md:p-10 rounded-3xl shadow-xl">
                            <h3 className="text-xl md:text-2xl font-bold text-gray-800 mb-6 flex items-center justify-center">
                                <Icon emoji="🤖" className="mr-3 text-3xl" />
                                生成AIへのプロンプト例
                            </h3>
                            <p className="text-lg text-center text-gray-700 mb-8">
                                ワークシートの5ステップに沿って、AIに指示を出します
                            </p>

                            {/* 冒頭の依頼文 */}
                            <div className="bg-white p-5 rounded-2xl border-2 border-gray-300 mb-6">
                                <p className="text-lg md:text-xl text-gray-800 leading-relaxed">
                                    <span className="font-bold">Google Apps Scriptで、以下の自動化ツールを作ってください。</span>
                                </p>
                            </div>

                            {/* 1️⃣ やりたいこと */}
                            <div className="bg-blue-50 p-6 rounded-2xl border-l-4 border-blue-400 mb-6">
                                <h4 className="text-lg md:text-xl font-bold text-blue-800 mb-4">【1️⃣ やりたいこと】</h4>
                                <p className="text-lg text-gray-700">
                                    Gmailの注文メールの内容を、既存のスプレッドシートに自動転記したい
                                </p>
                            </div>

                            {/* 2️⃣ 現在の手順 */}
                            <div className="bg-purple-50 p-6 rounded-2xl border-l-4 border-purple-400 mb-6">
                                <h4 className="text-lg md:text-xl font-bold text-purple-800 mb-4">【2️⃣ 現在の手順】</h4>
                                <div className="space-y-2">
                                    <p className="text-lg text-gray-700">1. Gmailを開く</p>
                                    <p className="text-lg text-gray-700">2. 件名に「注文受付」を含むメールを検索</p>
                                    <p className="text-lg text-gray-700">3. メール本文から注文情報を確認</p>
                                    <p className="text-lg text-gray-700">4. スプレッドシートを開いて手動で転記</p>
                                </div>
                            </div>

                            {/* 3️⃣ どんなデータを扱う？ */}
                            <div className="bg-gray-50 p-6 rounded-2xl border-l-4 border-gray-400 mb-6">
                                <h4 className="text-lg md:text-xl font-bold text-gray-800 mb-4">【3️⃣ どんなデータを扱う？】</h4>

                                <p className="text-lg font-bold text-gray-800 mb-3">■ 対象メール：</p>
                                <div className="space-y-1 mb-5">
                                    <p className="text-lg text-gray-700">• 件名に「注文受付」が含まれるメール</p>
                                    <p className="text-lg text-gray-700">• 「処理済み」ラベルが付いていないメール</p>
                                    <p className="text-lg text-gray-700">• 最新50件まで取得</p>
                                </div>

                                <p className="text-lg font-bold text-gray-800 mb-3">■ メール本文のサンプル：</p>
                                <div className="bg-white p-5 rounded-xl border border-gray-300 mb-5 text-lg text-gray-700 leading-relaxed font-mono" style={{whiteSpace: 'pre-line'}}>
━━━━━━━━━━━━━━━━━━
ご注文ありがとうございます
━━━━━━━━━━━━━━━━━━

注文ID: 12345
注文日時: 2025/10/28 14:30
お客様名: 山田太郎
メールアドレス: yamada@example.com
電話番号: 090-1234-5678

【ご注文内容】
商品名: 有機りんご 5kg
数量: 2箱
小計: 5,600円

配送先住所: 東京都渋谷区〇〇1-2-3
配送希望日: 2025/11/01
                                </div>

                                <p className="text-lg font-bold text-gray-800 mb-3">■ 抽出したいデータと転記先の列：</p>
                                <p className="text-base text-gray-600 mb-3 italic">※ Part 2で作成した転記項目表をここに貼り付けてください</p>
                                <div className="bg-white p-5 rounded-xl border border-gray-300">
                                    <pre className="text-base text-gray-700 overflow-x-auto" style={{fontFamily: 'monospace', whiteSpace: 'pre'}}>
{`項目名           列   抽出内容サンプル
─────────────────────────────────────
注文ID           C    12345
注文日時         E    2025/10/28 14:30
お客様名         G    山田太郎
商品名           J    有機りんご 5kg
金額             L    5600 ※カンマ・円記号除去
配送希望日       N    2025/11/01`}
                                    </pre>
                                </div>
                            </div>

                            {/* 4️⃣ どこに保存する？ */}
                            <div className="bg-orange-50 p-6 rounded-2xl border-l-4 border-orange-400 mb-6">
                                <h4 className="text-lg md:text-xl font-bold text-orange-800 mb-4">【4️⃣ どこに保存する？】</h4>
                                <div className="space-y-2">
                                    <p className="text-lg text-gray-700">• <span className="font-bold">現在のスプレッドシート</span>の「受注一覧」シートに追記</p>
                                    <p className="text-lg text-gray-700">• <span className="font-bold">注文IDの列の最終行を取得して、その次の行から追記</span>してください</p>
                                    <p className="text-lg text-gray-700">• 指定した列（C, E, G, J, L, N列など）にのみ書き込む</p>
                                    <p className="text-lg text-gray-700">• 他の列のデータは変更しない</p>
                                </div>
                            </div>

                            {/* 5️⃣ 重複防止とその他の要望 */}
                            <div className="bg-green-50 p-6 rounded-2xl border-l-4 border-green-400 mb-6">
                                <h4 className="text-lg md:text-xl font-bold text-green-800 mb-5">【5️⃣ 重複防止とその他の要望】</h4>

                                <div className="bg-white p-5 rounded-xl mb-5">
                                    <p className="text-lg md:text-xl font-bold text-red-700 mb-4">■ 重複防止の仕組み（超重要！）</p>

                                    <p className="text-lg font-bold text-gray-800 mb-2">▼ メール側での防止：</p>
                                    <div className="space-y-2 mb-4 ml-4">
                                        <p className="text-lg text-gray-700">• 処理が完了したメールには「<span className="font-bold text-green-700">処理済み</span>」ラベルを自動で付与</p>
                                        <p className="text-lg text-gray-700">• 「処理済み」ラベルが付いているメールは処理対象外にする</p>
                                        <p className="text-lg text-gray-700">• 検索条件に「<span className="font-mono bg-gray-100 px-2 py-1 rounded">-label:処理済み</span>」を追加</p>
                                    </div>

                                    <p className="text-lg font-bold text-gray-800 mb-2">▼ シート側での防止：</p>
                                    <div className="space-y-2 ml-4">
                                        <p className="text-lg text-gray-700">• 注文IDでシート内を検索し、すでに存在する場合はスキップ</p>
                                        <p className="text-lg text-gray-700">• 重複があった場合はログに記録する</p>
                                    </div>
                                </div>

                                <p className="text-lg font-bold text-gray-800 mb-3">■ その他の要望：</p>
                                <div className="space-y-2">
                                    <p className="text-lg text-gray-700">• メール本文から正規表現で各項目を抽出してください</p>
                                    <p className="text-lg text-gray-700">• エラーハンドリングを入れてください</p>
                                    <p className="text-lg text-gray-700">• 初心者向けに、コメント付きで分かりやすいコードをお願いします</p>
                                </div>
                            </div>

                            {/* ポイント */}
                            <div className="bg-blue-50 p-6 rounded-2xl mt-6">
                                <p className="text-lg md:text-xl text-gray-700 leading-relaxed">
                                    <span className="font-bold text-blue-700">💡 ポイント：</span><br/>
                                    ワークシートの5ステップに沿って書くことで、<span className="font-bold">AIが迷わず正確なコードを生成</span>できます！<br/>
                                    自分の業務に合わせて、各セクションをカスタマイズしてください。
                                </p>
                            </div>
                        </div>
                    </div>
                </section>
            );
        };

        // ⑧ 実践①-4：実行編
        const Practice1Part4Section = () => {
            return (
                <section className="section-snap min-h-screen flex items-center justify-center px-4 pt-16 pb-28 fade-in-up" id="section-practice1-4">
                    <div className="max-w-5xl mx-auto w-full">
                        <h2 className="text-3xl md:text-4xl font-black text-center mb-6 gradient-text">
                            📧 実践① 注文メール → スプレッドシート転記
                        </h2>
                        <p className="text-lg md:text-xl text-center text-gray-600 mb-8">Part 4: 実行編</p>

                        {/* 実行手順 */}
                        <div className="glass-card p-6 md:p-8 rounded-3xl shadow-xl">
                            <h3 className="text-xl md:text-2xl font-bold text-gray-800 mb-6 text-center">
                                実行手順
                            </h3>
                            <div className="space-y-4 max-w-4xl mx-auto">
                                <div className="flex items-start">
                                    <div className="step-number gradient-bg mr-3 flex-shrink-0">1</div>
                                    <p className="text-lg md:text-xl text-gray-700 mt-3">ChatGPTにプロンプトを送る → コードが作成される</p>
                                </div>
                                <div className="flex items-start">
                                    <div className="step-number gradient-bg mr-3 flex-shrink-0">2</div>
                                    <p className="text-lg md:text-xl text-gray-700 mt-3">スプレッドシートを開く → 「拡張機能 → Apps Script」</p>
                                </div>
                                <div className="flex items-start">
                                    <div className="step-number gradient-bg mr-3 flex-shrink-0">3</div>
                                    <p className="text-lg md:text-xl text-gray-700 mt-3">コードを貼り付け保存</p>
                                </div>
                                <div className="flex items-start">
                                    <div className="step-number gradient-bg mr-3 flex-shrink-0">4</div>
                                    <p className="text-lg md:text-xl text-gray-700 mt-3">エディタ上で関数を選び、▶ 実行</p>
                                </div>
                                <div className="flex items-start">
                                    <div className="step-number gradient-bg mr-3 flex-shrink-0">5</div>
                                    <p className="text-lg md:text-xl text-gray-700 mt-3">初回は権限許可のダイアログに従って承認</p>
                                </div>
                                <div className="flex items-start">
                                    <div className="step-number gradient-bg mr-3 flex-shrink-0">6</div>
                                    <div className="mt-3">
                                        <p className="text-lg md:text-xl text-orange-600 font-black">シートに転記されれば成功！</p>
                                        <p className="text-3xl md:text-4xl mt-2">🎉</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            );
        };

        // ⑨ 実践①-5：まとめ
        const Practice1SummarySection = () => {
            return (
                <section className="section-snap min-h-screen flex items-center justify-center px-4 pt-16 pb-28 fade-in-up" id="section-practice1-5">
                    <div className="max-w-5xl mx-auto w-full">
                        <h2 className="text-3xl md:text-4xl font-black text-center mb-6 gradient-text">
                            📧 実践① 注文メール → スプレッドシート転記
                        </h2>
                        <p className="text-lg md:text-xl text-center text-gray-600 mb-12">まとめ</p>

                        <div className="space-y-8">
                            {/* この実践で学んだこと */}
                            <div className="glass-card p-8 md:p-10 rounded-3xl shadow-xl bg-blue-50 border-2 border-blue-300">
                                <h3 className="text-xl md:text-2xl font-bold text-gray-800 mb-6 flex items-center">
                                    <span className="text-3xl mr-3">🎓</span>
                                    この実践で学んだこと
                                </h3>
                                <p className="text-lg md:text-xl text-gray-700 leading-relaxed">
                                    注文メールから必要な情報を自動抽出し、1クリックでスプレッドシートに転記する仕組みを作成しました。
                                    メール処理の効率が大幅に向上し、手作業のミスも防げます。
                                </p>
                            </div>

                            {/* 重要ポイント */}
                            <div className="glass-card p-8 md:p-10 rounded-3xl shadow-xl border-4 border-orange-400">
                                <h3 className="text-xl md:text-2xl font-bold text-gray-800 mb-6 flex items-center">
                                    <span className="text-3xl mr-3">⭐</span>
                                    重要ポイントの再確認
                                </h3>
                                <div className="space-y-4">
                                    <div className="flex items-start">
                                        <span className="text-orange-600 font-black text-xl mr-3 mt-1">✓</span>
                                        <p className="text-lg md:text-xl text-gray-700">
                                            <span className="font-bold">転記項目を事前に設計</span>することでAIが正確にコード生成できる
                                        </p>
                                    </div>
                                    <div className="flex items-start">
                                        <span className="text-orange-600 font-black text-xl mr-3 mt-1">✓</span>
                                        <p className="text-lg md:text-xl text-gray-700">
                                            <span className="font-bold">メール形式とシート列構成をプロンプトに含める</span>ことが重要
                                        </p>
                                    </div>
                                    <div className="flex items-start">
                                        <span className="text-orange-600 font-black text-xl mr-3 mt-1">✓</span>
                                        <p className="text-lg md:text-xl text-gray-700">
                                            <span className="font-bold">重複防止の仕組み</span>（ラベル+ID検索）で二重転記を防ぐ
                                        </p>
                                    </div>
                                </div>
                            </div>

                            {/* 実行ステップの振り返り */}
                            <div className="glass-card p-8 md:p-10 rounded-3xl shadow-xl bg-green-50 border-2 border-green-300">
                                <h3 className="text-xl md:text-2xl font-bold text-gray-800 mb-6 flex items-center">
                                    <span className="text-3xl mr-3">🔄</span>
                                    実行ステップの振り返り
                                </h3>
                                <div className="text-center">
                                    <p className="text-lg md:text-xl text-gray-700 font-bold">
                                        <span className="inline-block bg-white px-4 py-2 rounded-xl shadow mx-2 my-1">① メールサンプル確認</span>
                                        <span className="text-green-600 text-2xl mx-2">→</span>
                                        <span className="inline-block bg-white px-4 py-2 rounded-xl shadow mx-2 my-1">② 転記項目を設計</span>
                                        <span className="text-green-600 text-2xl mx-2">→</span>
                                        <span className="inline-block bg-white px-4 py-2 rounded-xl shadow mx-2 my-1">③ AIでコード生成</span>
                                        <span className="text-green-600 text-2xl mx-2">→</span>
                                        <span className="inline-block bg-white px-4 py-2 rounded-xl shadow mx-2 my-1">④ GASに貼り付けて実行</span>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            );
        };
        // セクションインジケーター
        const SectionIndicator = () => {
            const [activeSection, setActiveSection] = useState(0);
            const targetSectionIndexRef = useRef(null);
            const sectionIds = [
                'section-title',
                'section-workflow',
                'section-worksheet',
                'section-practice1-0',
                'section-practice1-1',
                'section-practice1-2',
                'section-practice1-3',
                'section-practice1-4',
                'section-practice1-5'
            ];

            const sectionNames = [
                '生成AI × GAS 実践編①',
                '作業の棚卸',
                '自動化ワークシート',
                '実践① この実践の流れ',
                '実践① Part 1: メールサンプル',
                '実践① Part 2: 転記項目',
                '実践① Part 3: プロンプト例',
                '実践① Part 4: 実行編',
                '実践① まとめ'
            ];

            useEffect(() => {
                const options = {
                    threshold: 0.1,
                    rootMargin: '0px'
                };

                let rafId = null;
                let lastUpdateTime = 0;

                const callback = (entries) => {
                    if (rafId) {
                        cancelAnimationFrame(rafId);
                    }

                    rafId = requestAnimationFrame(() => {
                        const now = Date.now();
                        if (now - lastUpdateTime < 100) {
                            return;
                        }
                        lastUpdateTime = now;

                        const isAtBottom = window.scrollY + window.innerHeight >= document.documentElement.scrollHeight - 10;
                        if (isAtBottom) {
                            setActiveSection(sectionIds.length - 1);
                            return;
                        }

                        const intersectingSections = entries.filter(entry => entry.isIntersecting);

                        if (intersectingSections.length > 0) {
                            const centerSection = intersectingSections.reduce((closest, entry) => {
                                const rect = entry.boundingClientRect;
                                const viewportHeight = window.innerHeight;
                                const sectionCenter = rect.top + rect.height / 2;
                                const viewportCenter = viewportHeight / 2;
                                const distanceFromCenter = Math.abs(sectionCenter - viewportCenter);

                                if (!closest) return entry;

                                const closestRect = closest.boundingClientRect;
                                const closestCenter = closestRect.top + closestRect.height / 2;
                                const closestDistance = Math.abs(closestCenter - viewportCenter);

                                return distanceFromCenter < closestDistance ? entry : closest;
                            }, null);

                            if (centerSection) {
                                const newIndex = sectionIds.indexOf(centerSection.target.id);
                                if (newIndex !== -1) {
                                    const isNavigating = targetSectionIndexRef.current !== null;
                                    const hysteresisThreshold = isNavigating ? 0 : 150;

                                    setActiveSection(prevIndex => {
                                        if (prevIndex === newIndex) {
                                            if (targetSectionIndexRef.current === newIndex) {
                                                targetSectionIndexRef.current = null;
                                            }
                                            return prevIndex;
                                        }

                                        const currentElement = document.getElementById(sectionIds[prevIndex]);
                                        if (currentElement) {
                                            const currentRect = currentElement.getBoundingClientRect();
                                            const currentCenter = currentRect.top + currentRect.height / 2;
                                            const currentDistance = Math.abs(currentCenter - window.innerHeight / 2);
                                            const newDistance = Math.abs(centerSection.boundingClientRect.top + centerSection.boundingClientRect.height / 2 - window.innerHeight / 2);

                                            if (Math.abs(newDistance - currentDistance) > hysteresisThreshold) {
                                                if (targetSectionIndexRef.current === newIndex) {
                                                    targetSectionIndexRef.current = null;
                                                }
                                                return newIndex;
                                            }
                                            return prevIndex;
                                        }

                                        return newIndex;
                                    });
                                }
                            }
                        }
                    });
                };

                const observer = new IntersectionObserver(callback, options);

                sectionIds.forEach(id => {
                    const element = document.getElementById(id);
                    if (element) {
                        observer.observe(element);
                    }
                });

                return () => {
                    if (rafId) {
                        cancelAnimationFrame(rafId);
                    }
                    sectionIds.forEach(id => {
                        const element = document.getElementById(id);
                        if (element) {
                            observer.unobserve(element);
                        }
                    });
                };
            }, []);

            const scrollToSection = (index) => {
                targetSectionIndexRef.current = index;
                setActiveSection(index);
                const element = document.getElementById(sectionIds[index]);
                if (element) {
                    element.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            };

            return (
                <div className="section-indicator">
                    {sectionIds.map((id, index) => (
                        <div key={id} className="section-indicator-item">
                            <span className="section-indicator-label">{sectionNames[index]}</span>
                            <div
                                className={`section-indicator-dot ${activeSection === index ? 'section-indicator-dot-active' : ''}`}
                                onClick={() => scrollToSection(index)}
                            />
                        </div>
                    ))}
                </div>
            );
        };

        // メインアプリ
        const App = () => {
            const sectionsRef = useRef([]);

            useEffect(() => {
                const observer = new IntersectionObserver(
                    (entries) => {
                        entries.forEach((entry) => {
                            if (entry.isIntersecting) {
                                entry.target.classList.add('visible');
                            }
                        });
                    },
                    { threshold: 0.1 }
                );

                sectionsRef.current = document.querySelectorAll('.fade-in-up');
                sectionsRef.current.forEach((section) => observer.observe(section));

                return () => {
                    sectionsRef.current.forEach((section) => observer.unobserve(section));
                };
            }, []);

            return (
                <div className="overflow-x-hidden">
                    {/* 9セクション構成 */}
                    <TitleSection />
                    <WorkflowSection />
                    <WorksheetSection />
                    <Practice1FlowSection />
                    <Practice1Part1Section />
                    <Practice1Part2Section />
                    <Practice1Part3Section />
                    <Practice1Part4Section />
                    <Practice1SummarySection />

                    {/* セクションインジケーター */}
                    <SectionIndicator />

                    {/* Footer */}
                    <footer className="py-8 text-center text-gray-500">
                        <p className="text-sm">生成AI × GAS 短期講座 | 実践編①</p>
                    </footer>
                </div>
            );
        };

        // レンダリング
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
